var so=Object.defineProperty;var Gi=s=>{throw TypeError(s)};var io=(s,e,t)=>e in s?so(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var A=(s,e,t)=>io(s,typeof e!="symbol"?e+"":e,t),Es=(s,e,t)=>e.has(s)||Gi("Cannot "+t);var c=(s,e,t)=>(Es(s,e,"read from private field"),t?t.call(s):e.get(s)),I=(s,e,t)=>e.has(s)?Gi("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),T=(s,e,t,i)=>(Es(s,e,"write to private field"),i?i.call(s,t):e.set(s,t),t),u=(s,e,t)=>(Es(s,e,"access private method"),t);import{B as ji,a as M,n as no,b as ro,A as oo,V as Tn}from"../GIZWWUBJ.js";import{E as fe,F as Ee,W as ao,M as ut,a as Ts,H as An,G as Qe}from"../qMueoN-g.js";import{W as S}from"../Bhjq7kBM.js";import{T as ae,a as co}from"../dUhtEGMt.js";import{A as Hi}from"../RGizDK4v.js";import{M as lo}from"../Ba4Z8Z7K.js";import{P as As}from"../DGrhe3kl.js";import{s as Wi}from"../B90Wz8hS.js";var Ue,z,ie,te,re,qe,Js,qs;class ds{constructor(e,t=null){I(this,qe);I(this,Ue);I(this,z);I(this,ie);I(this,te);I(this,re);T(this,Ue,e),t&&T(this,z,t)}addEventListeners(e){c(this,z)?u(this,qe,qs).call(this,e):u(this,qe,Js).call(this,e)}removeEventListeners(){c(this,z)?(c(this,z).onNewEvent.removeEventListener("event",c(this,ie)),c(this,z).onInfoUpdate.removeEventListener("info-update",c(this,te)),c(this,z).onError.removeEventListener("error",c(this,te)),c(this,z).unsetRequiredFeatures()):(overwolf.games.events.onNewEvents.removeListener(c(this,ie)),overwolf.games.events.onInfoUpdates2.removeListener(c(this,te)),overwolf.games.events.onError.removeListener(c(this,re))),T(this,ie,null),T(this,te,null),T(this,re,null),console.log(`[Game Events Service | ${c(this,z)?"Custom":"Default"}] Event listeners are inactive now.`)}static triggerEvent(e,t,i){overwolf.games.events.provider.triggerEvent(e,t,i)}static triggerInfoUpdate(e,t,i,n){overwolf.games.events.provider.updateInfo({feature:e,category:t,key:i,value:n})}static getGameInfo(){return new Promise(e=>{overwolf.games.events.getInfo(t=>{t.success?e(t.res):e(null)})})}static async getGameEventsStatus(e,t=null){try{const i=`https://game-events-status.overwolf.com/${e}_prod.json?v=${Date.now()}`,r=await(await fetch(i)).json();let o=r.state;if(t&&o===2){o=1;for(let a of r.features)if(a.state!==1&&t.includes(a.name)){o=2;break}}switch(o){case 1:return"green";case 2:return"yellow";case 3:return"red";default:return null}}catch(i){return console.error(i.message),null}}}Ue=new WeakMap,z=new WeakMap,ie=new WeakMap,te=new WeakMap,re=new WeakMap,qe=new WeakSet,Js=function(e){console.log(`[Game Events Service | Default] Setting required features: ${JSON.stringify(c(this,Ue))}.`),overwolf.games.events.setRequiredFeatures(c(this,Ue),t=>{t.success?(console.log(`[Game Events Service | Default] Required features set: ${JSON.stringify(t.supportedFeatures)}.`),e!=null&&e.onNewEvent&&(c(this,ie)&&overwolf.games.events.onNewEvents.removeListener(c(this,ie)),T(this,ie,i=>{for(const n of i.events)console.log(`[Game Events Service | Default | Event Fired] ${JSON.stringify(n)}`),e.onNewEvent(n)}),overwolf.games.events.onNewEvents.addListener(c(this,ie))),e!=null&&e.onInfoUpdate&&(c(this,te)&&overwolf.games.events.onInfoUpdates2.removeListener(c(this,te)),T(this,te,i=>{console.log(`[Game Events Service | Default | Info Update] ${JSON.stringify(i)}`),e.onInfoUpdate(i)}),overwolf.games.events.onInfoUpdates2.addListener(c(this,te))),e!=null&&e.onError&&(c(this,re)&&overwolf.games.events.onError.removeListener(c(this,re)),T(this,re,i=>{console.error(`[Game Events Service | Default | Error] ${JSON.stringify(i)}`),e.onError(i)}),overwolf.games.events.onError.addListener(c(this,re))),console.log("[Game Events Service | Default] Event listeners are active now.")):(console.warn(`[Game Events Service | Default] Failed to set required features. Reason: "${t.error}". (Retrying in 5 seconds.)`),setTimeout(()=>{u(this,qe,Js).call(this,e)},5e3))})},qs=function(e){console.log(`[Game Events Service | Custom] Setting required features: ${JSON.stringify(c(this,Ue))}.`),c(this,z).setRequiredFeatures(c(this,Ue),t=>{t.success?(console.log(`[Game Events Service | Custom] Required features set: ${JSON.stringify(t.supportedFeatures)}.`),e!=null&&e.onNewEvent&&(c(this,ie)&&c(this,z).onNewEvent.removeEventListener("event",c(this,ie)),T(this,ie,i=>{console.log(`[Game Events Service | Custom | Event Fired] ${JSON.stringify(i.detail)}`),e.onNewEvent(i.detail)}),c(this,z).onNewEvent.addEventListener("event",c(this,ie))),e!=null&&e.onInfoUpdate&&(c(this,te)&&c(this,z).onInfoUpdate.removeEventListener("info-update",c(this,te)),T(this,te,i=>{console.log(`[Game Events Service | Custom | Info Update] ${JSON.stringify(i.detail)}`),e.onInfoUpdate(i.detail)}),c(this,z).onInfoUpdate.addEventListener("info-update",c(this,te))),e!=null&&e.onError&&(c(this,re)&&c(this,z).onError.removeEventListener("error",c(this,re)),T(this,re,i=>{console.log(`[Game Events Service | Custom | Error] ${JSON.stringify(i.detail)}`),e.onError(i.detail)}),c(this,z).onError.addEventListener("error",c(this,re))),console.log("[Game Events Service | Custom] Event listeners are active now.")):(console.warn(`[Game Events Service | Custom] Failed to set required features. Reason: "${t.error}". (Retrying in 5 seconds.)`),setTimeout(()=>{u(this,qe,qs).call(this,e)},5e3))})};var Pe;class ho{constructor(){I(this,Pe)}addEventListeners(e){e!=null&&e.onLanguageChanged&&(c(this,Pe)&&overwolf.settings.language.onLanguageChanged.removeListener(c(this,Pe)),T(this,Pe,t=>{const i=t.language;e.onLanguageChanged(i)}),overwolf.settings.language.onLanguageChanged.addListener(c(this,Pe))),console.log("[Language Service] Event listeners are active now.")}removeEventListeners(){overwolf.settings.language.onLanguageChanged.removeListener(c(this,Pe)),T(this,Pe,null),console.log("[Language Service] Event listeners are inactive now.")}static getCurrentLanguage(){return new Promise(e=>{overwolf.settings.language.get(t=>{t.success?e(t.language):e(null)})})}}Pe=new WeakMap;var Oe,De;class dt{constructor(){I(this,Oe);I(this,De)}addEventListeners(e){e!=null&&e.onLoginStateChanged&&(c(this,Oe)&&overwolf.profile.onLoginStateChanged.removeListener(c(this,Oe)),T(this,Oe,t=>{const i=t.connectionState,n=t.username||null;e.onLoginStateChanged(i,n)}),overwolf.profile.onLoginStateChanged.addListener(c(this,Oe))),e!=null&&e.onSubscriptionChanged&&(c(this,De)&&overwolf.profile.subscriptions.onSubscriptionChanged.removeListener(c(this,De)),T(this,De,t=>{const i=t.plans.map(n=>({planId:n}));e.onSubscriptionChanged(i)}),overwolf.profile.subscriptions.onSubscriptionChanged.addListener(c(this,De))),console.log("[Profile Service] Event listeners are active now.")}removeEventListeners(){overwolf.profile.onLoginStateChanged.removeListener(c(this,Oe)),overwolf.profile.subscriptions.onSubscriptionChanged.removeListener(c(this,De)),T(this,Oe,null),T(this,De,null),console.log("[Profile Service] Event listeners are inactive now.")}static getCurrentUserInfo(){return new Promise(e=>{overwolf.profile.getCurrentUser(t=>{e({clientId:t.userId,machineId:t.machineId,channelId:t.channel,username:t.username||null,avatarUrl:t.avatar||null})})})}static getOverwolfUserInfo(){return new Promise(e=>{overwolf.profile.getCurrentUser(t=>{if(t.uuid){const i=t.emailHashes||null;i&&!localStorage.emailHashesSystemId&&overwolf.extensions.current.setUserEmailHashes(i,()=>{localStorage.emailHashesSystemId="overwolf"}),e({userId:t.uuid,username:t.username,avatarUrl:t.avatar||null,partnerId:t.partnerId||null})}else e(null)})})}static getCurrentSubscriptions(){return new Promise(e=>{overwolf.profile.subscriptions.getDetailedActivePlans(t=>{var i;t.success&&((i=t.plans)==null?void 0:i.length)>0?e(t.plans.map(n=>({planId:n.planId,status:n.state,expiryDate:n.expiryDate}))):e(null)})})}static isSubscribed(e,t){return!!(e!=null&&e.find(i=>i.planId===t))}}Oe=new WeakMap,De=new WeakMap;class Cs{static getMonitors(){return new Promise(e=>{overwolf.utils.getMonitorsList(t=>{t.success?e(t.displays.map(i=>({id:String(i.handle.value),name:i.name,isPrimary:i.is_primary,width:i.width,height:i.height,leftOffset:i.x,topOffset:i.y,dpiX:i.dpiX,dpiY:i.dpiY}))):e(null)})})}static getSystemInfo(){return new Promise(e=>{overwolf.utils.getSystemInformation(t=>{t.success?e(t.systemInfo):e(null)})})}static getRegionalInfo(){return new Promise(e=>{overwolf.os.getRegionInfo(t=>{t.success?e({language:t.info.name,dateFormat:t.info.date_format,timeFormat:t.info.time_format,currency:t.info.currency_symbol}):e(null)})})}}let Ks;var Zt,En;(typeof navigator>"u"||!((En=(Zt=navigator.userAgent)==null?void 0:Zt.startsWith)!=null&&En.call(Zt,"Mozilla/5.0 ")))&&(Ks="oauth4webapi/v2.17.0");function Kt(s,e){if(s==null)return!1;try{return s instanceof e||Object.getPrototypeOf(s)[Symbol.toStringTag]===e.prototype[Symbol.toStringTag]}catch{return!1}}const Mt=Symbol(),uo=Symbol(),Cn=Symbol(),kn=Symbol(),Rn=Symbol(),fo=Symbol(),po=new TextEncoder,mo=new TextDecoder;function He(s){return typeof s=="string"?po.encode(s):mo.decode(s)}const Vi=32768;function go(s){s instanceof ArrayBuffer&&(s=new Uint8Array(s));const e=[];for(let t=0;t<s.byteLength;t+=Vi)e.push(String.fromCharCode.apply(null,s.subarray(t,t+Vi)));return btoa(e.join("")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function wo(s){try{const e=atob(s.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"")),t=new Uint8Array(e.length);for(let i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}catch(e){throw new _("The input to be decoded is not correctly encoded.",{cause:e})}}function Be(s){return typeof s=="string"?wo(s):go(s)}class yo{constructor(e){this.cache=new Map,this._cache=new Map,this.maxSize=e}get(e){let t=this.cache.get(e);if(t)return t;if(t=this._cache.get(e))return this.update(e,t),t}has(e){return this.cache.has(e)||this._cache.has(e)}set(e,t){return this.cache.has(e)?this.cache.set(e,t):this.update(e,t),this}delete(e){return this.cache.has(e)?this.cache.delete(e):this._cache.has(e)?this._cache.delete(e):!1}update(e,t){this.cache.set(e,t),this.cache.size>=this.maxSize&&(this._cache=this.cache,this.cache=new Map)}}class ye extends Error{constructor(e){var t;super(e??"operation not supported"),this.name=this.constructor.name,(t=Error.captureStackTrace)==null||t.call(Error,this,this.constructor)}}class So extends Error{constructor(e,t){var i;super(e,t),this.name=this.constructor.name,(i=Error.captureStackTrace)==null||i.call(Error,this,this.constructor)}}const _=So,Nn=new yo(100);function Pn(s){return s instanceof CryptoKey}function On(s){return Pn(s)&&s.type==="private"}function bo(s){return Pn(s)&&s.type==="public"}function Dn(s){try{const e=s.headers.get("dpop-nonce");e&&Nn.set(new URL(s.url).origin,e)}catch{}return s}function bt(s){return!(s===null||typeof s!="object"||Array.isArray(s))}function Ii(s){Kt(s,Headers)&&(s=Object.fromEntries(s.entries()));const e=new Headers(s);if(Ks&&!e.has("user-agent")&&e.set("user-agent",Ks),e.has("authorization"))throw new TypeError('"options.headers" must not include the "authorization" header name');if(e.has("dpop"))throw new TypeError('"options.headers" must not include the "dpop" header name');return e}function Ln(s){if(typeof s=="function"&&(s=s()),!(s instanceof AbortSignal))throw new TypeError('"options.signal" must return or be an instance of AbortSignal');return s}function H(s){return typeof s=="string"&&s.length!==0}async function Xt(s,e){if(!(s instanceof URL))throw new TypeError('"expectedIssuer" must be an instance of URL');if(!Kt(e,Response))throw new TypeError('"response" must be an instance of Response');if(e.status!==200)throw new _('"response" is not a conform Authorization Server Metadata response');Bt(e);let t;try{t=await e.json()}catch(i){throw new _('failed to parse "response" body as JSON',{cause:i})}if(!bt(t))throw new _('"response" body must be a top level object');if(!H(t.issuer))throw new _('"response" body "issuer" property must be a non-empty string');if(new URL(t.issuer).href!==s.href)throw new _('"response" body "issuer" does not match "expectedIssuer"');return t}function Ei(){return Be(crypto.getRandomValues(new Uint8Array(32)))}function vo(){return Ei()}async function _o(s){if(!H(s))throw new TypeError('"codeVerifier" must be a non-empty string');return Be(await crypto.subtle.digest("SHA-256",He(s)))}function Io(s){if(s instanceof CryptoKey)return{key:s};if(!((s==null?void 0:s.key)instanceof CryptoKey))return{};if(s.kid!==void 0&&!H(s.kid))throw new TypeError('"kid" must be a non-empty string');return{key:s.key,kid:s.kid,modifyAssertion:s[kn]}}function zi(s){return encodeURIComponent(s).replace(/%20/g,"+")}function Eo(s,e){const t=zi(s),i=zi(e);return`Basic ${btoa(`${t}:${i}`)}`}function To(s){switch(s.algorithm.hash.name){case"SHA-256":return"PS256";case"SHA-384":return"PS384";case"SHA-512":return"PS512";default:throw new ye("unsupported RsaHashedKeyAlgorithm hash name")}}function Ao(s){switch(s.algorithm.hash.name){case"SHA-256":return"RS256";case"SHA-384":return"RS384";case"SHA-512":return"RS512";default:throw new ye("unsupported RsaHashedKeyAlgorithm hash name")}}function Co(s){switch(s.algorithm.namedCurve){case"P-256":return"ES256";case"P-384":return"ES384";case"P-521":return"ES512";default:throw new ye("unsupported EcKeyAlgorithm namedCurve")}}function Mn(s){switch(s.algorithm.name){case"RSA-PSS":return To(s);case"RSASSA-PKCS1-v1_5":return Ao(s);case"ECDSA":return Co(s);case"Ed25519":case"Ed448":return"EdDSA";default:throw new ye("unsupported CryptoKey algorithm name")}}function _t(s){const e=s==null?void 0:s[Mt];return typeof e=="number"&&Number.isFinite(e)?e:0}function Ti(s){const e=s==null?void 0:s[uo];return typeof e=="number"&&Number.isFinite(e)&&Math.sign(e)!==-1?e:30}function ys(){return Math.floor(Date.now()/1e3)}function ko(s,e){const t=ys()+_t(e);return{jti:Ei(),aud:[s.issuer,s.token_endpoint],exp:t+60,iat:t,nbf:t,iss:e.client_id,sub:e.client_id}}async function Ro(s,e,t,i,n){const r={alg:Mn(t),kid:i},o=ko(s,e);return n==null||n(r,o),Bn(r,o,t)}function It(s){if(typeof s!="object"||s===null)throw new TypeError('"as" must be an object');if(!H(s.issuer))throw new TypeError('"as.issuer" property must be a non-empty string');return!0}function Et(s){if(typeof s!="object"||s===null)throw new TypeError('"client" must be an object');if(!H(s.client_id))throw new TypeError('"client.client_id" property must be a non-empty string');return!0}function Ji(s){if(!H(s))throw new TypeError('"client.client_secret" property must be a non-empty string');return s}function ks(s,e){if(e!==void 0)throw new TypeError(`"options.clientPrivateKey" property must not be provided when ${s} client authentication method is used.`)}function qi(s,e){if(e!==void 0)throw new TypeError(`"client.client_secret" property must not be provided when ${s} client authentication method is used.`)}async function No(s,e,t,i,n){switch(t.delete("client_secret"),t.delete("client_assertion_type"),t.delete("client_assertion"),e.token_endpoint_auth_method){case void 0:case"client_secret_basic":{ks("client_secret_basic",n),i.set("authorization",Eo(e.client_id,Ji(e.client_secret)));break}case"client_secret_post":{ks("client_secret_post",n),t.set("client_id",e.client_id),t.set("client_secret",Ji(e.client_secret));break}case"private_key_jwt":{if(qi("private_key_jwt",e.client_secret),n===void 0)throw new TypeError('"options.clientPrivateKey" must be provided when "client.token_endpoint_auth_method" is "private_key_jwt"');const{key:r,kid:o,modifyAssertion:a}=Io(n);if(!On(r))throw new TypeError('"options.clientPrivateKey.key" must be a private CryptoKey');t.set("client_id",e.client_id),t.set("client_assertion_type","urn:ietf:params:oauth:client-assertion-type:jwt-bearer"),t.set("client_assertion",await Ro(s,e,r,o,a));break}case"tls_client_auth":case"self_signed_tls_client_auth":case"none":{qi(e.token_endpoint_auth_method,e.client_secret),ks(e.token_endpoint_auth_method,n),t.set("client_id",e.client_id);break}default:throw new ye("unsupported client token_endpoint_auth_method")}}async function Bn(s,e,t){if(!t.usages.includes("sign"))throw new TypeError('CryptoKey instances used for signing assertions must include "sign" in their "usages"');const i=`${Be(He(JSON.stringify(s)))}.${Be(He(JSON.stringify(e)))}`,n=Be(await crypto.subtle.sign(Vn(t),t,He(i)));return`${i}.${n}`}async function Po(s,e,t,i,n,r){var f;const{privateKey:o,publicKey:a,nonce:l=Nn.get(t.origin)}=e;if(!On(o))throw new TypeError('"DPoP.privateKey" must be a private CryptoKey');if(!bo(a))throw new TypeError('"DPoP.publicKey" must be a public CryptoKey');if(l!==void 0&&!H(l))throw new TypeError('"DPoP.nonce" must be a non-empty string or undefined');if(!a.extractable)throw new TypeError('"DPoP.publicKey.extractable" must be true');const h=ys()+n,d={alg:Mn(o),typ:"dpop+jwt",jwk:await Do(a)},p={iat:h,jti:Ei(),htm:i,nonce:l,htu:`${t.origin}${t.pathname}`,ath:r?Be(await crypto.subtle.digest("SHA-256",He(r))):void 0};(f=e[kn])==null||f.call(e,d,p),s.set("dpop",await Bn(d,p,o))}let es;async function Oo(s){const{kty:e,e:t,n:i,x:n,y:r,crv:o}=await crypto.subtle.exportKey("jwk",s),a={kty:e,e:t,n:i,x:n,y:r,crv:o};return es.set(s,a),a}async function Do(s){return es||(es=new WeakMap),es.get(s)||Oo(s)}function Ki(s,e,t){if(typeof s!="string")throw t?new TypeError(`"as.mtls_endpoint_aliases.${e}" must be a string`):new TypeError(`"as.${e}" must be a string`);return new URL(s)}function $n(s,e,t=!1){return t&&s.mtls_endpoint_aliases&&e in s.mtls_endpoint_aliases?Ki(s.mtls_endpoint_aliases[e],e,t):Ki(s[e],e,t)}function xn(s,e){return!!(s.use_mtls_endpoint_aliases||e!=null&&e[fo])}function ts(s){const e=s;return typeof e!="object"||Array.isArray(e)||e===null?!1:e.error!==void 0}function Lo(s){return s.length>=2&&s[0]==='"'&&s[s.length-1]==='"'?s.slice(1,-1):s}const Mo=/((?:,|, )?[0-9a-zA-Z!#$%&'*+-.^_`|~]+=)/,Bo=/(?:^|, ?)([0-9a-zA-Z!#$%&'*+\-.^_`|~]+)(?=$|[ ,])/g;function $o(s,e){const t=e.split(Mo).slice(1);if(!t.length)return{scheme:s.toLowerCase(),parameters:{}};t[t.length-1]=t[t.length-1].replace(/,$/,"");const i={};for(let n=1;n<t.length;n+=2){const r=n;if(t[r][0]==='"')for(;t[r].slice(-1)!=='"'&&++n<t.length;)t[r]+=t[n];const o=t[r-1].replace(/^(?:, ?)|=$/g,"").toLowerCase();i[o]=Lo(t[r])}return{scheme:s.toLowerCase(),parameters:i}}function xo(s){if(!Kt(s,Response))throw new TypeError('"response" must be an instance of Response');const e=s.headers.get("www-authenticate");if(e===null)return;const t=[];for(const{1:n,index:r}of e.matchAll(Bo))t.push([n,r]);return t.length?t.map(([n,r],o,a)=>{const l=a[o+1];let h;return l?h=e.slice(r,l[1]):h=e.slice(r),$o(n,h)}):void 0}async function Uo(s,e,t,i,n,r){if(!H(s))throw new TypeError('"accessToken" must be a non-empty string');if(!(t instanceof URL))throw new TypeError('"url" must be an instance of URL');return i=Ii(i),(r==null?void 0:r.DPoP)===void 0?i.set("authorization",`Bearer ${s}`):(await Po(i,r.DPoP,t,e.toUpperCase(),_t({[Mt]:r==null?void 0:r[Mt]}),s),i.set("authorization",`DPoP ${s}`)),((r==null?void 0:r[Cn])||fetch)(t.href,{body:n,headers:Object.fromEntries(i.entries()),method:e,redirect:"manual",signal:r!=null&&r.signal?Ln(r.signal):null}).then(Dn)}async function Xi(s,e,t,i){It(s),Et(e);const n=$n(s,"userinfo_endpoint",xn(e,i)),r=Ii(i==null?void 0:i.headers);return e.userinfo_signed_response_alg?r.set("accept","application/jwt"):(r.set("accept","application/json"),r.append("accept","application/jwt")),Uo(t,"GET",n,r,null,{...i,[Mt]:_t(e)})}const Fo=Symbol();function Go(s){var e;return(e=s.headers.get("content-type"))==null?void 0:e.split(";")[0]}async function Yi(s,e,t,i){if(It(s),Et(e),!Kt(i,Response))throw new TypeError('"response" must be an instance of Response');if(i.status!==200)throw new _('"response" is not a conform UserInfo Endpoint response');let n;if(Go(i)==="application/jwt"){Bt(i);const{claims:r,jwt:o}=await zn(await i.text(),Jn.bind(void 0,e.userinfo_signed_response_alg,s.userinfo_signing_alg_values_supported),Ai,_t(e),Ti(e),e[Rn]).then(zo.bind(void 0,e.client_id)).then(Jo.bind(void 0,s.issuer));Wo.set(i,o),n=r}else{if(e.userinfo_signed_response_alg)throw new _("JWT UserInfo Response expected");Bt(i);try{n=await i.json()}catch(r){throw new _('failed to parse "response" body as JSON',{cause:r})}}if(!bt(n))throw new _('"response" body must be a top level object');if(!H(n.sub))throw new _('"response" body "sub" property must be a non-empty string');switch(t){case Fo:break;default:if(!H(t))throw new _('"expectedSubject" must be a non-empty string');if(n.sub!==t)throw new _('unexpected "response" body "sub" value')}return n}async function jo(s,e,t,i,n,r,o){return await No(s,e,n,r,o==null?void 0:o.clientPrivateKey),r.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),((o==null?void 0:o[Cn])||fetch)(i.href,{body:n,headers:Object.fromEntries(r.entries()),method:t,redirect:"manual",signal:o!=null&&o.signal?Ln(o.signal):null}).then(Dn)}async function Un(s,e,t,i,n){const r=$n(s,"token_endpoint",xn(e,n));i.set("grant_type",t);const o=Ii(n==null?void 0:n.headers);return o.set("accept","application/json"),jo(s,e,"POST",r,i,o,n)}async function Ho(s,e,t,i){if(It(s),Et(e),!H(t))throw new TypeError('"refreshToken" must be a non-empty string');const n=new URLSearchParams(i==null?void 0:i.additionalParameters);return n.set("refresh_token",t),Un(s,e,"refresh_token",n,i)}const Fn=new WeakMap,Wo=new WeakMap;function Xs(s){if(!s.id_token)return;const e=Fn.get(s);if(!e)throw new TypeError('"ref" was already garbage collected or did not resolve from the proper sources');return e[0]}async function Gn(s,e,t,i=!1,n=!1){if(It(s),Et(e),!Kt(t,Response))throw new TypeError('"response" must be an instance of Response');if(t.status!==200){let o;if(o=await ea(t))return o;throw new _('"response" is not a conform Token Endpoint response')}Bt(t);let r;try{r=await t.json()}catch(o){throw new _('failed to parse "response" body as JSON',{cause:o})}if(!bt(r))throw new _('"response" body must be a top level object');if(!H(r.access_token))throw new _('"response" body "access_token" property must be a non-empty string');if(!H(r.token_type))throw new _('"response" body "token_type" property must be a non-empty string');if(r.token_type=r.token_type.toLowerCase(),r.token_type!=="dpop"&&r.token_type!=="bearer")throw new ye("unsupported `token_type` value");if(r.expires_in!==void 0&&(typeof r.expires_in!="number"||r.expires_in<=0))throw new _('"response" body "expires_in" property must be a positive number');if(!n&&r.refresh_token!==void 0&&!H(r.refresh_token))throw new _('"response" body "refresh_token" property must be a non-empty string');if(r.scope!==void 0&&typeof r.scope!="string")throw new _('"response" body "scope" property must be a string');if(!i){if(r.id_token!==void 0&&!H(r.id_token))throw new _('"response" body "id_token" property must be a non-empty string');if(r.id_token){const{claims:o,jwt:a}=await zn(r.id_token,Jn.bind(void 0,e.id_token_signed_response_alg,s.id_token_signing_alg_values_supported),Ai,_t(e),Ti(e),e[Rn]).then(Yo.bind(void 0,["aud","exp","iat","iss","sub"])).then(Hn.bind(void 0,s.issuer)).then(jn.bind(void 0,e.client_id));if(Array.isArray(o.aud)&&o.aud.length!==1){if(o.azp===void 0)throw new _('ID Token "aud" (audience) claim includes additional untrusted audiences');if(o.azp!==e.client_id)throw new _('unexpected ID Token "azp" (authorized party) claim value')}if(o.auth_time!==void 0&&(!Number.isFinite(o.auth_time)||Math.sign(o.auth_time)!==1))throw new _('ID Token "auth_time" (authentication time) must be a positive number');Fn.set(r,[o,a])}}return r}async function Vo(s,e,t){return Gn(s,e,t)}function zo(s,e){return e.claims.aud!==void 0?jn(s,e):e}function jn(s,e){if(Array.isArray(e.claims.aud)){if(!e.claims.aud.includes(s))throw new _('unexpected JWT "aud" (audience) claim value')}else if(e.claims.aud!==s)throw new _('unexpected JWT "aud" (audience) claim value');return e}function Jo(s,e){return e.claims.iss!==void 0?Hn(s,e):e}function Hn(s,e){if(e.claims.iss!==s)throw new _('unexpected JWT "iss" (issuer) claim value');return e}const Wn=new WeakSet;function qo(s){return Wn.add(s),s}async function Ko(s,e,t,i,n,r){if(It(s),Et(e),!Wn.has(t))throw new TypeError('"callbackParameters" must be an instance of URLSearchParams obtained from "validateAuthResponse()", or "validateJwtAuthResponse()');if(!H(i))throw new TypeError('"redirectUri" must be a non-empty string');if(!H(n))throw new TypeError('"codeVerifier" must be a non-empty string');const o=ke(t,"code");if(!o)throw new _('no authorization code in "callbackParameters"');const a=new URLSearchParams(r==null?void 0:r.additionalParameters);return a.set("redirect_uri",i),a.set("code_verifier",n),a.set("code",o),Un(s,e,"authorization_code",a,r)}const Xo={aud:"audience",c_hash:"code hash",client_id:"client id",exp:"expiration time",iat:"issued at",iss:"issuer",jti:"jwt id",nonce:"nonce",s_hash:"state hash",sub:"subject",ath:"access token hash",htm:"http method",htu:"http uri",cnf:"confirmation"};function Yo(s,e){for(const t of s)if(e.claims[t]===void 0)throw new _(`JWT "${t}" (${Xo[t]}) claim missing`);return e}const Qo=Symbol(),Rs=Symbol();async function Zo(s,e,t,i,n){const r=await Gn(s,e,t);if(ts(r))return r;if(!H(r.id_token))throw new _('"response" body "id_token" property must be a non-empty string');n??(n=e.default_max_age??Rs);const o=Xs(r);if((e.require_auth_time||n!==Rs)&&o.auth_time===void 0)throw new _('ID Token "auth_time" (authentication time) claim missing');if(n!==Rs){if(typeof n!="number"||n<0)throw new TypeError('"maxAge" must be a non-negative number');const a=ys()+_t(e),l=Ti(e);if(o.auth_time+n<a-l)throw new _("too much time has elapsed since the last End-User authentication")}switch(i){case void 0:case Qo:if(o.nonce!==void 0)throw new _('unexpected ID Token "nonce" claim value');break;default:if(!H(i))throw new TypeError('"expectedNonce" must be a non-empty string');if(o.nonce===void 0)throw new _('ID Token "nonce" claim missing');if(o.nonce!==i)throw new _('unexpected ID Token "nonce" claim value')}return r}function Bt(s){if(s.bodyUsed)throw new TypeError('"response" body has been used already')}async function ea(s){if(s.status>399&&s.status<500){Bt(s);try{const e=await s.json();if(bt(e)&&typeof e.error=="string"&&e.error.length)return e.error_description!==void 0&&typeof e.error_description!="string"&&delete e.error_description,e.error_uri!==void 0&&typeof e.error_uri!="string"&&delete e.error_uri,e.algs!==void 0&&typeof e.algs!="string"&&delete e.algs,e.scope!==void 0&&typeof e.scope!="string"&&delete e.scope,e}catch{}}}function Qi(s){if(typeof s.modulusLength!="number"||s.modulusLength<2048)throw new _(`${s.name} modulusLength must be at least 2048 bits`)}function ta(s){switch(s){case"P-256":return"SHA-256";case"P-384":return"SHA-384";case"P-521":return"SHA-512";default:throw new ye}}function Vn(s){switch(s.algorithm.name){case"ECDSA":return{name:s.algorithm.name,hash:ta(s.algorithm.namedCurve)};case"RSA-PSS":switch(Qi(s.algorithm),s.algorithm.hash.name){case"SHA-256":case"SHA-384":case"SHA-512":return{name:s.algorithm.name,saltLength:parseInt(s.algorithm.hash.name.slice(-3),10)>>3};default:throw new ye}case"RSASSA-PKCS1-v1_5":return Qi(s.algorithm),s.algorithm.name;case"Ed448":case"Ed25519":return s.algorithm.name}throw new ye}const Ai=Symbol();async function sa(s,e,t,i){const n=`${s}.${e}`;if(!await crypto.subtle.verify(Vn(t),t,i,He(n)))throw new _("JWT signature verification failed")}async function zn(s,e,t,i,n,r){let{0:o,1:a,2:l,length:h}=s.split(".");if(h===5)if(r!==void 0)s=await r(s),{0:o,1:a,2:l,length:h}=s.split(".");else throw new ye("JWE structure JWTs are not supported");if(h!==3)throw new _("Invalid JWT");let d;try{d=JSON.parse(He(Be(o)))}catch(g){throw new _("failed to parse JWT Header body as base64url encoded JSON",{cause:g})}if(!bt(d))throw new _("JWT Header must be a top level object");if(e(d),d.crit!==void 0)throw new _('unexpected JWT "crit" header parameter');const p=Be(l);let f;t!==Ai&&(f=await t(d),await sa(o,a,f,p));let w;try{w=JSON.parse(He(Be(a)))}catch(g){throw new _("failed to parse JWT Payload body as base64url encoded JSON",{cause:g})}if(!bt(w))throw new _("JWT Payload must be a top level object");const y=ys()+i;if(w.exp!==void 0){if(typeof w.exp!="number")throw new _('unexpected JWT "exp" (expiration time) claim type');if(w.exp<=y-n)throw new _('unexpected JWT "exp" (expiration time) claim value, timestamp is <= now()')}if(w.iat!==void 0&&typeof w.iat!="number")throw new _('unexpected JWT "iat" (issued at) claim type');if(w.iss!==void 0&&typeof w.iss!="string")throw new _('unexpected JWT "iss" (issuer) claim type');if(w.nbf!==void 0){if(typeof w.nbf!="number")throw new _('unexpected JWT "nbf" (not before) claim type');if(w.nbf>y+n)throw new _('unexpected JWT "nbf" (not before) claim value, timestamp is > now()')}if(w.aud!==void 0&&typeof w.aud!="string"&&!Array.isArray(w.aud))throw new _('unexpected JWT "aud" (audience) claim type');return{header:d,claims:w,signature:p,key:f,jwt:s}}function Jn(s,e,t){if(s!==void 0){if(t.alg!==s)throw new _('unexpected JWT "alg" header parameter');return}if(Array.isArray(e)){if(!e.includes(t.alg))throw new _('unexpected JWT "alg" header parameter');return}if(t.alg!=="RS256")throw new _('unexpected JWT "alg" header parameter')}function ke(s,e){const{0:t,length:i}=s.getAll(e);if(i>1)throw new _(`"${e}" parameter must be provided only once`);return t}const ia=Symbol(),na=Symbol();function ra(s,e,t,i){if(It(s),Et(e),t instanceof URL&&(t=t.searchParams),!(t instanceof URLSearchParams))throw new TypeError('"parameters" must be an instance of URLSearchParams, or URL');if(ke(t,"response"))throw new _('"parameters" contains a JARM response, use validateJwtAuthResponse() instead of validateAuthResponse()');const n=ke(t,"iss"),r=ke(t,"state");if(!n&&s.authorization_response_iss_parameter_supported)throw new _('response parameter "iss" (issuer) missing');if(n&&n!==s.issuer)throw new _('unexpected "iss" (issuer) response parameter value');switch(i){case void 0:case na:if(r!==void 0)throw new _('unexpected "state" response parameter encountered');break;case ia:break;default:if(!H(i))throw new _('"expectedState" must be a non-empty string');if(r===void 0)throw new _('response parameter "state" missing');if(r!==i)throw new _('unexpected "state" response parameter value')}const o=ke(t,"error");if(o)return{error:o,error_description:ke(t,"error_description"),error_uri:ke(t,"error_uri")};const a=ke(t,"id_token"),l=ke(t,"token");if(a!==void 0||l!==void 0)throw new ye("implicit and hybrid flows are not supported");return qo(new URLSearchParams(t))}const K=[];for(let s=0;s<256;++s)K.push((s+256).toString(16).slice(1));function oa(s,e=0){return(K[s[e+0]]+K[s[e+1]]+K[s[e+2]]+K[s[e+3]]+"-"+K[s[e+4]]+K[s[e+5]]+"-"+K[s[e+6]]+K[s[e+7]]+"-"+K[s[e+8]]+K[s[e+9]]+"-"+K[s[e+10]]+K[s[e+11]]+K[s[e+12]]+K[s[e+13]]+K[s[e+14]]+K[s[e+15]]).toLowerCase()}let Ns;const aa=new Uint8Array(16);function ca(){if(!Ns){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Ns=crypto.getRandomValues.bind(crypto)}return Ns(aa)}const la=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Zi={randomUUID:la};function ha(s,e,t){if(Zi.randomUUID&&!e&&!s)return Zi.randomUUID();s=s||{};const i=s.random||(s.rng||ca)();return i[6]=i[6]&15|64,i[8]=i[8]&63|128,oa(i)}var Le,gt,wt,it,Me,k,Ze,Ys,Re,Nt,Pt,Ot,Qs;class ua{constructor(e){I(this,k);I(this,Le);I(this,gt,0);I(this,wt);I(this,it,new EventTarget);I(this,Me);T(this,Le,e)}addEventListeners(e){e.onLoginStateChanged&&(c(this,Me)&&c(this,it).removeEventListener("event",c(this,Me)),T(this,Me,t=>{const i=t.detail.state,n=t.detail.user;e.onLoginStateChanged(i,n)}),c(this,it).addEventListener("event",c(this,Me)))}removeEventListeners(e=null){(!e||e.includes("onLoginStateChanged"))&&(c(this,it).removeEventListener("event",c(this,Me)),T(this,Me,null))}async signInRedirect(e=null,t={}){console.log("[Auth Service] The redirect-based sign-in flow is initiated.");const i=u(this,k,Ys).call(this);localStorage.setItem(`auth.${i}.flow`,"redirect");const n=new URL(c(this,Le).authUri),r=await u(this,k,Nt).call(this,n).then(u(this,k,Pt).bind(this)).then(d=>Xt(n,d)),o=u(this,k,Ot).call(this,e),a=vo();localStorage.setItem(`auth.${i}.codeVerifier`,a);const l=await _o(a),h=new URL(r.authorization_endpoint);h.searchParams.set("client_id",o.client_id),h.searchParams.set("code_challenge",l),h.searchParams.set("code_challenge_method","S256"),h.searchParams.set("redirect_uri",o.redirect_uri),h.searchParams.set("response_type",o.response_type),h.searchParams.set("scope",o.scope),h.searchParams.set("state",i),Object.keys(t).forEach(d=>{h.searchParams.set(d,t[d])}),console.log("[Auth Service] The redirect-based sign-in flow is transferred to a system browser."),ji.openUrlInSystemBrowser(h.href)}async signInSilent(e=null){console.log("[Auth Service] The silent-based sign-in flow is initiated.");const t=u(this,k,Ys).call(this);localStorage.setItem(`auth.${t}.flow`,"silent");let i=localStorage.getItem("auth.tokens")?JSON.parse(localStorage.getItem("auth.tokens")):null,n=localStorage.getItem("auth.claims")?JSON.parse(localStorage.getItem("auth.claims")):null;if(!i||!n)return console.error("[Auth Service] The silent-based sign-in flow failed due to missing tokens or claims."),u(this,k,Ze).call(this,{state:"offline",user:null}),null;const r=new URL(c(this,Le).authUri),o=await u(this,k,Nt).call(this,r).then(u(this,k,Pt).bind(this)).then(y=>Xt(r,y)),a=u(this,k,Ot).call(this,e),h=1e3*JSON.parse(atob(i.access_token.split(".")[1])).exp,d=10*60*1e3,p=h-d;if(Date.now()>=p){console.log("[Auth Service] The authentication tokens are expired. Requesting new ones...");try{const y=await Ho(o,a,i.refresh_token);if(i=await Vo(o,a,y),ts(i))throw u(this,k,Re).call(this),new Error("[Auth Service] OAuth2Error");n=Xs(i),localStorage.setItem("auth.tokens",JSON.stringify(i)),localStorage.setItem("auth.claims",JSON.stringify(n))}catch(y){return console.error(`[Auth Service] The silent-based sign-in flow failed due to an error that happened while refreshing tokens: ${JSON.stringify(y)}.`),M.notify(`[Auth Service] The silent-based sign-in flow failed due to an error that happened while refreshing tokens: ${JSON.stringify(y)}.`),null}}try{const y=await Xi(o,a,i.access_token),g=await Yi(o,a,n.sub,y);return console.log("[Auth Service] The silent-based sign-in flow has been completed successfully."),u(this,k,Qs).call(this,i),u(this,k,Ze).call(this,{state:"online",user:{...i,profile:g}}),{...i,profile:g}}catch(y){return console.error(`[Auth Service] The silent-based sign-in flow failed due to an error that happened while fetching information about a user: ${JSON.stringify(y)}.`),M.notify(`[Auth Service] The silent-based sign-in flow failed due to an error that happened while fetching information about a user: ${JSON.stringify(y)}.`),u(this,k,Ze).call(this,{state:"offline",user:null}),null}}async signOutRedirect(e=null){console.log("[Auth Service] The redirect-based sign-out flow is initiated.");const t=localStorage.getItem("auth.tokens")?JSON.parse(localStorage.getItem("auth.tokens")):null;if(u(this,k,Re).call(this),!t)return;const i=new URL(c(this,Le).authUri),n=await u(this,k,Nt).call(this,i).then(u(this,k,Pt).bind(this)).then(a=>Xt(i,a)),r=u(this,k,Ot).call(this,e),o=new URL(n.end_session_endpoint);o.searchParams.set("id_token_hint",t.id_token),o.searchParams.set("post_logout_redirect_uri",r.post_logout_redirect_uri),ji.openUrlInSystemBrowser(o.href)}signOutSilent(){console.log("[Auth Service] The silent-based sign-out flow is initiated."),u(this,k,Re).call(this),console.log("[Auth Service] The silent-based sign-out flow has been completed successfully.")}async signInCallback(e=null,t=""){console.log("[Auth Service] The redirect-based sign-in flow returned to the app from the system browser.");const n=new URLSearchParams(t).get("state"),r=n;console.log(`[Auth Service] Auth service (signInCallback) received state: ${n}`);const o=localStorage.getItem(`auth.${r}.flow`)||"redirect";localStorage.removeItem(`auth.${r}.flow`),console.log(`[Auth Service] Auth service (signInCallback) using flow: ${o}`);const a=new URL(c(this,Le).authUri),l=await u(this,k,Nt).call(this,a).then(u(this,k,Pt).bind(this)).then(C=>Xt(a,C)),h=u(this,k,Ot).call(this,e);console.log("[Auth Service] Auth service (signInCallback) reached authority, validating auth");const d=new URL(window.location.href+"&"+t.split("?")[1]);let p=null;try{p=ra(l,h,d,r),console.log("[Auth Service] Auth service (signInCallback) successfully validated auth")}catch(C){return u(this,k,Re).call(this),console.error(`[Auth Service] Auth service (signInCallback) validation failed, error: ${JSON.stringify(C)}`),M.notify(`[Auth Service] Auth service (signInCallback) validation failed, error: ${JSON.stringify(C)}`),null}let f=localStorage.getItem(`auth.${r}.codeVerifier`);if(localStorage.removeItem(`auth.${r}.codeVerifier`),ts(p))return u(this,k,Re).call(this),console.log(`[Auth Service] Auth service (signInCallback) failed, oauth error. Params: ${JSON.stringify(p)}`),M.notify(`[Auth Service] Auth service (signInCallback) failed, oauth error. Params: ${JSON.stringify(p)}`),null;if(!f)return u(this,k,Re).call(this),console.error("[Auth Service] No code verifier, invalid sign in"),M.notify("[Auth Service] No code verifier, invalid sign in"),null;const w=await Ko(l,h,p,{popup:h.popup_redirect_uri,redirect:h.redirect_uri,silent:h.silent_redirect_uri}[o],f);let y=null;if(y=xo(w)){for(const C of y)console.error("[Auth Service] Auth Error: Challenge error",C);return u(this,k,Re).call(this),console.error("[Auth Service] Auth Error: Challenge error"),M.notify("[Auth Service] Auth Error: Challenge error"),null}const g=await Zo(l,h,w);if(ts(g))return u(this,k,Re).call(this),console.error(`[Auth Service] Auth Error: OAuth 2 error: ${JSON.stringify(g)}`),M.notify(`[Auth Service] Auth Error: OAuth 2 error: ${JSON.stringify(g)}`),null;localStorage.setItem("auth.tokens",JSON.stringify(g));let v=Xs(g);localStorage.setItem("auth.claims",JSON.stringify(v));try{const C=await Xi(l,h,g.access_token),Y=await Yi(l,h,v.sub,C);return console.log("[Auth Service] The redirect-based sign-in flow has been completed successfully."),u(this,k,Qs).call(this,g),u(this,k,Ze).call(this,{state:"online",user:{...g,profile:Y}}),{...g,profile:Y}}catch(C){return console.error(`[Auth Service] The redirect-based sign-in flow failed due to an error that happened while fetching information about a user: ${JSON.stringify(C)}.`),M.notify(`[Auth Service] The redirect-based sign-in flow failed due to an error that happened while fetching information about a user: ${JSON.stringify(C)}.`),u(this,k,Ze).call(this,{state:"offline",user:null}),null}}signOutCallback(){console.log("[Auth Service] The redirect-based sign-out flow has been completed successfully.")}}Le=new WeakMap,gt=new WeakMap,wt=new WeakMap,it=new WeakMap,Me=new WeakMap,k=new WeakSet,Ze=function(e){const t=new CustomEvent("event",{detail:e});c(this,it).dispatchEvent(t)},Ys=function(){const e=localStorage.getItem("auth.requests")?JSON.parse(localStorage.getItem("auth.requests")):[],t=ha();for(e.unshift(t);e.length>5;){const i=e.pop();localStorage.removeItem(`auth.${i}.flow`),localStorage.removeItem(`auth.${i}.codeVerifier`)}return localStorage.setItem("auth.requests",JSON.stringify(e)),t},Re=function(){localStorage.removeItem("auth.tokens"),localStorage.removeItem("auth.claims"),clearTimeout(c(this,wt)),u(this,k,Ze).call(this,{state:"offline",user:null})},Nt=function(e){const t=new URL(e.href);t.pathname=`${t.pathname}/.well-known/openid-configuration`.replace("//","/");const i=new Headers;return i.set("Accept","application/json"),fetch(t,{mode:"cors",cache:"no-store",headers:i})},Pt=function(e){const t=e.headers.get("date")||new Date().toISOString(),i=new Date(t).getTime()/1e3,n=new Date().getTime()/1e3;return T(this,gt,i-n),console.log(`[Auth Service] The client clock skew is ${c(this,gt)}.`),e},Ot=function(e=null){return{...c(this,Le).oauth,...e,[Mt]:c(this,gt),token_endpoint_auth_method:"none"}},Qs=function(e){const i=1e3*JSON.parse(atob(e.access_token.split(".")[1])).exp,n=10*60*1e3,r=i-n,o=Date.now(),a=r-o;console.log(`[Auth Service] The app will refresh authentication tokens automatically in ${Math.round(a/60/1e3)} minutes.`),clearTimeout(c(this,wt)),T(this,wt,setTimeout(async()=>{console.log("[Auth Service] Refreshing authentication tokens..."),await this.signInSilent()},a))};var en={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qn=function(s){const e=[];let t=0;for(let i=0;i<s.length;i++){let n=s.charCodeAt(i);n<128?e[t++]=n:n<2048?(e[t++]=n>>6|192,e[t++]=n&63|128):(n&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(n=65536+((n&1023)<<10)+(s.charCodeAt(++i)&1023),e[t++]=n>>18|240,e[t++]=n>>12&63|128,e[t++]=n>>6&63|128,e[t++]=n&63|128):(e[t++]=n>>12|224,e[t++]=n>>6&63|128,e[t++]=n&63|128)}return e},da=function(s){const e=[];let t=0,i=0;for(;t<s.length;){const n=s[t++];if(n<128)e[i++]=String.fromCharCode(n);else if(n>191&&n<224){const r=s[t++];e[i++]=String.fromCharCode((n&31)<<6|r&63)}else if(n>239&&n<365){const r=s[t++],o=s[t++],a=s[t++],l=((n&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{const r=s[t++],o=s[t++];e[i++]=String.fromCharCode((n&15)<<12|(r&63)<<6|o&63)}}return e.join("")},Kn={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let n=0;n<s.length;n+=3){const r=s[n],o=n+1<s.length,a=o?s[n+1]:0,l=n+2<s.length,h=l?s[n+2]:0,d=r>>2,p=(r&3)<<4|a>>4;let f=(a&15)<<2|h>>6,w=h&63;l||(w=64,o||(f=64)),i.push(t[d],t[p],t[f],t[w])}return i.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(qn(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):da(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let n=0;n<s.length;){const r=t[s.charAt(n++)],a=n<s.length?t[s.charAt(n)]:0;++n;const h=n<s.length?t[s.charAt(n)]:64;++n;const p=n<s.length?t[s.charAt(n)]:64;if(++n,r==null||a==null||h==null||p==null)throw new fa;const f=r<<2|a>>4;if(i.push(f),h!==64){const w=a<<4&240|h>>2;if(i.push(w),p!==64){const y=h<<6&192|p;i.push(y)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class fa extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const pa=function(s){const e=qn(s);return Kn.encodeByteArray(e,!0)},Xn=function(s){return pa(s).replace(/\./g,"")},ma=function(s){try{return Kn.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ga(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wa=()=>ga().__FIREBASE_DEFAULTS__,ya=()=>{if(typeof process>"u"||typeof en>"u")return;const s=en.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},Sa=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&ma(s[1]);return e&&JSON.parse(e)},ba=()=>{try{return wa()||ya()||Sa()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},Yn=()=>{var s;return(s=ba())===null||s===void 0?void 0:s.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function Qn(){try{return typeof indexedDB=="object"}catch{return!1}}function _a(){return new Promise((s,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",n=self.indexedDB.open(i);n.onsuccess=()=>{n.result.close(),t||self.indexedDB.deleteDatabase(i),s(!0)},n.onupgradeneeded=()=>{t=!1},n.onerror=()=>{var r;e(((r=n.error)===null||r===void 0?void 0:r.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ia="FirebaseError";class Xe extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=Ia,Object.setPrototypeOf(this,Xe.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ss.prototype.create)}}class Ss{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},n=`${this.service}/${e}`,r=this.errors[e],o=r?Ea(r,i):"Error",a=`${this.serviceName}: ${o} (${n}).`;return new Xe(n,a,i)}}function Ea(s,e){return s.replace(Ta,(t,i)=>{const n=e[i];return n!=null?String(n):`<${i}?>`})}const Ta=/\{\$([^}]+)}/g;function Zs(s,e){if(s===e)return!0;const t=Object.keys(s),i=Object.keys(e);for(const n of t){if(!i.includes(n))return!1;const r=s[n],o=e[n];if(tn(r)&&tn(o)){if(!Zs(r,o))return!1}else if(r!==o)return!1}for(const n of i)if(!t.includes(n))return!1;return!0}function tn(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aa=1e3,Ca=2,ka=4*60*60*1e3,Ra=.5;function Na(s,e=Aa,t=Ca){const i=e*Math.pow(t,s),n=Math.round(Ra*i*(Math.random()-.5)*2);return Math.min(ka,i+n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tt(s){return s&&s._delegate?s._delegate:s}class at{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const et="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new va;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&i.resolve(n)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(r){if(n)return null;throw r}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Da(e))try{this.getOrInitializeService({instanceIdentifier:et})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const r=this.getOrInitializeService({instanceIdentifier:n});i.resolve(r)}catch{}}}}clearInstance(e=et){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=et){return this.instances.has(e)}getOptions(e=et){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const n=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);i===a&&o.resolve(n)}return n}onInit(e,t){var i;const n=this.normalizeInstanceIdentifier(t),r=(i=this.onInitCallbacks.get(n))!==null&&i!==void 0?i:new Set;r.add(e),this.onInitCallbacks.set(n,r);const o=this.instances.get(n);return o&&e(o,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const n of i)try{n(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Oa(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=et){return this.component?this.component.multipleInstances?e:et:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Oa(s){return s===et?void 0:s}function Da(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Pa(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var B;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(B||(B={}));const Ma={debug:B.DEBUG,verbose:B.VERBOSE,info:B.INFO,warn:B.WARN,error:B.ERROR,silent:B.SILENT},Ba=B.INFO,$a={[B.DEBUG]:"log",[B.VERBOSE]:"log",[B.INFO]:"info",[B.WARN]:"warn",[B.ERROR]:"error"},xa=(s,e,...t)=>{if(e<s.logLevel)return;const i=new Date().toISOString(),n=$a[e];if(n)console[n](`[${i}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Zn{constructor(e){this.name=e,this._logLevel=Ba,this._logHandler=xa,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in B))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Ma[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,B.DEBUG,...e),this._logHandler(this,B.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,B.VERBOSE,...e),this._logHandler(this,B.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,B.INFO,...e),this._logHandler(this,B.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,B.WARN,...e),this._logHandler(this,B.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,B.ERROR,...e),this._logHandler(this,B.ERROR,...e)}}const Ua=(s,e)=>e.some(t=>s instanceof t);let sn,nn;function Fa(){return sn||(sn=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ga(){return nn||(nn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const er=new WeakMap,ei=new WeakMap,tr=new WeakMap,Ps=new WeakMap,Ci=new WeakMap;function ja(s){const e=new Promise((t,i)=>{const n=()=>{s.removeEventListener("success",r),s.removeEventListener("error",o)},r=()=>{t(We(s.result)),n()},o=()=>{i(s.error),n()};s.addEventListener("success",r),s.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&er.set(t,s)}).catch(()=>{}),Ci.set(e,s),e}function Ha(s){if(ei.has(s))return;const e=new Promise((t,i)=>{const n=()=>{s.removeEventListener("complete",r),s.removeEventListener("error",o),s.removeEventListener("abort",o)},r=()=>{t(),n()},o=()=>{i(s.error||new DOMException("AbortError","AbortError")),n()};s.addEventListener("complete",r),s.addEventListener("error",o),s.addEventListener("abort",o)});ei.set(s,e)}let ti={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return ei.get(s);if(e==="objectStoreNames")return s.objectStoreNames||tr.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return We(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function Wa(s){ti=s(ti)}function Va(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=s.call(Os(this),e,...t);return tr.set(i,e.sort?e.sort():[e]),We(i)}:Ga().includes(s)?function(...e){return s.apply(Os(this),e),We(er.get(this))}:function(...e){return We(s.apply(Os(this),e))}}function za(s){return typeof s=="function"?Va(s):(s instanceof IDBTransaction&&Ha(s),Ua(s,Fa())?new Proxy(s,ti):s)}function We(s){if(s instanceof IDBRequest)return ja(s);if(Ps.has(s))return Ps.get(s);const e=za(s);return e!==s&&(Ps.set(s,e),Ci.set(e,s)),e}const Os=s=>Ci.get(s);function sr(s,e,{blocked:t,upgrade:i,blocking:n,terminated:r}={}){const o=indexedDB.open(s,e),a=We(o);return i&&o.addEventListener("upgradeneeded",l=>{i(We(o.result),l.oldVersion,l.newVersion,We(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{r&&l.addEventListener("close",()=>r()),n&&l.addEventListener("versionchange",h=>n(h.oldVersion,h.newVersion,h))}).catch(()=>{}),a}const Ja=["get","getKey","getAll","getAllKeys","count"],qa=["put","add","delete","clear"],Ds=new Map;function rn(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Ds.get(e))return Ds.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,n=qa.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(n||Ja.includes(t)))return;const r=async function(o,...a){const l=this.transaction(o,n?"readwrite":"readonly");let h=l.store;return i&&(h=h.index(a.shift())),(await Promise.all([h[t](...a),n&&l.done]))[0]};return Ds.set(e,r),r}Wa(s=>({...s,get:(e,t,i)=>rn(e,t)||s.get(e,t,i),has:(e,t)=>!!rn(e,t)||s.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ka{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Xa(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function Xa(s){const e=s.getComponent();return(e==null?void 0:e.type)==="VERSION"}const si="@firebase/app",on="0.10.15";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $e=new Zn("@firebase/app"),Ya="@firebase/app-compat",Qa="@firebase/analytics-compat",Za="@firebase/analytics",ec="@firebase/app-check-compat",tc="@firebase/app-check",sc="@firebase/auth",ic="@firebase/auth-compat",nc="@firebase/database",rc="@firebase/data-connect",oc="@firebase/database-compat",ac="@firebase/functions",cc="@firebase/functions-compat",lc="@firebase/installations",hc="@firebase/installations-compat",uc="@firebase/messaging",dc="@firebase/messaging-compat",fc="@firebase/performance",pc="@firebase/performance-compat",mc="@firebase/remote-config",gc="@firebase/remote-config-compat",wc="@firebase/storage",yc="@firebase/storage-compat",Sc="@firebase/firestore",bc="@firebase/vertexai",vc="@firebase/firestore-compat",_c="firebase",Ic="11.0.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ii="[DEFAULT]",Ec={[si]:"fire-core",[Ya]:"fire-core-compat",[Za]:"fire-analytics",[Qa]:"fire-analytics-compat",[tc]:"fire-app-check",[ec]:"fire-app-check-compat",[sc]:"fire-auth",[ic]:"fire-auth-compat",[nc]:"fire-rtdb",[rc]:"fire-data-connect",[oc]:"fire-rtdb-compat",[ac]:"fire-fn",[cc]:"fire-fn-compat",[lc]:"fire-iid",[hc]:"fire-iid-compat",[uc]:"fire-fcm",[dc]:"fire-fcm-compat",[fc]:"fire-perf",[pc]:"fire-perf-compat",[mc]:"fire-rc",[gc]:"fire-rc-compat",[wc]:"fire-gcs",[yc]:"fire-gcs-compat",[Sc]:"fire-fst",[vc]:"fire-fst-compat",[bc]:"fire-vertex","fire-js":"fire-js",[_c]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $t=new Map,Tc=new Map,ni=new Map;function an(s,e){try{s.container.addComponent(e)}catch(t){$e.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function vt(s){const e=s.name;if(ni.has(e))return $e.debug(`There were multiple attempts to register component ${e}.`),!1;ni.set(e,s);for(const t of $t.values())an(t,s);for(const t of Tc.values())an(t,s);return!0}function ki(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ac={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ve=new Ss("app","Firebase",Ac);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new at("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ve.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kc=Ic;function Ri(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const i=Object.assign({name:ii,automaticDataCollectionEnabled:!1},e),n=i.name;if(typeof n!="string"||!n)throw Ve.create("bad-app-name",{appName:String(n)});if(t||(t=Yn()),!t)throw Ve.create("no-options");const r=$t.get(n);if(r){if(Zs(t,r.options)&&Zs(i,r.config))return r;throw Ve.create("duplicate-app",{appName:n})}const o=new La(n);for(const l of ni.values())o.addComponent(l);const a=new Cc(t,i,o);return $t.set(n,a),a}function ir(s=ii){const e=$t.get(s);if(!e&&s===ii&&Yn())return Ri();if(!e)throw Ve.create("no-app",{appName:s});return e}function Rc(){return Array.from($t.values())}function ze(s,e,t){var i;let n=(i=Ec[s])!==null&&i!==void 0?i:s;t&&(n+=`-${t}`);const r=n.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const a=[`Unable to register library "${n}" with version "${e}":`];r&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),r&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),$e.warn(a.join(" "));return}vt(new at(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nc="firebase-heartbeat-database",Pc=1,xt="firebase-heartbeat-store";let Ls=null;function nr(){return Ls||(Ls=sr(Nc,Pc,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(xt)}catch(t){console.warn(t)}}}}).catch(s=>{throw Ve.create("idb-open",{originalErrorMessage:s.message})})),Ls}async function Oc(s){try{const t=(await nr()).transaction(xt),i=await t.objectStore(xt).get(rr(s));return await t.done,i}catch(e){if(e instanceof Xe)$e.warn(e.message);else{const t=Ve.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});$e.warn(t.message)}}}async function cn(s,e){try{const i=(await nr()).transaction(xt,"readwrite");await i.objectStore(xt).put(e,rr(s)),await i.done}catch(t){if(t instanceof Xe)$e.warn(t.message);else{const i=Ve.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});$e.warn(i.message)}}}function rr(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dc=1024,Lc=30*24*60*60*1e3;class Mc{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new $c(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=ln();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r)?void 0:(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=Lc}),this._storage.overwrite(this._heartbeatsCache))}catch(i){$e.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=ln(),{heartbeatsToSend:i,unsentEntries:n}=Bc(this._heartbeatsCache.heartbeats),r=Xn(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(t){return $e.warn(t),""}}}function ln(){return new Date().toISOString().substring(0,10)}function Bc(s,e=Dc){const t=[];let i=s.slice();for(const n of s){const r=t.find(o=>o.agent===n.agent);if(r){if(r.dates.push(n.date),hn(t)>e){r.dates.pop();break}}else if(t.push({agent:n.agent,dates:[n.date]}),hn(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class $c{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Qn()?_a().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Oc(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return cn(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return cn(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function hn(s){return Xn(JSON.stringify({version:2,heartbeats:s})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xc(s){vt(new at("platform-logger",e=>new Ka(e),"PRIVATE")),vt(new at("heartbeat",e=>new Mc(e),"PRIVATE")),ze(si,on,s),ze(si,on,"esm2017"),ze("fire-js","")}xc("");var Uc="firebase",Fc="11.0.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ze(Uc,Fc,"app");var ps;const _e=class _e{static initialize(){const e="main";Rc().find(t=>t.name===e)?_e.app=ir(e):_e.app=Ri(c(_e,ps),e)}static getApp(){return _e.app||_e.initialize(),_e.app}};ps=new WeakMap,I(_e,ps,{apiKey:"AIzaSyAKouR6XS-9rBKVIBicGk7_p0WBeWx3Hik",authDomain:"tracker-network-overwolf.firebaseapp.com",projectId:"tracker-network-overwolf",storageBucket:"tracker-network-overwolf.appspot.com",messagingSenderId:"970579491600",appId:"1:970579491600:web:146dac5039ea37daa78395",measurementId:"G-FT7V9DFSPX"}),A(_e,"app",null);let ri=_e;var ms,Ut,gs,Ft,Gt,X,Ke,oi,ai;class Gc{constructor(){I(this,Ke);I(this,ms,"TtUIEBPUT2yvsdc7ZqqFfw");I(this,Ut);I(this,gs,"https://www.google-analytics.com/mp/collect");I(this,Ft);I(this,Gt);I(this,X,{timeoutFlag:null,timeBetweenEvents:1e3*10,maxEvents:20,isAwaitingToBeSend:!1,events:[]});const e=ri.getApp();T(this,Ut,e.options.measurementId),overwolf.windows.getMainWindow().firebaseAnalytics=this,console.log("[Firebase Analytics] Initializing Firebase Analytics service.")}logEvent(e,t){if(c(this,X).events.push({name:e,params:t}),console.log(`[Firebase Analytics] Event "${e}" is logged.`,JSON.stringify(t)),c(this,X).isAwaitingToBeSend){c(this,X).events.length>=c(this,X).maxEvents&&(u(this,Ke,oi).call(this),console.log(`[Firebase Analytics] ${c(this,X).events.length} Event(s) are sent to Firebase Analytics.`));return}c(this,X).isAwaitingToBeSend=!0,this.timeoutFlag=setTimeout(()=>{u(this,Ke,oi).call(this)},c(this,X).timeBetweenEvents)}setUserId(e){T(this,Gt,e)}setClientId(e){T(this,Ft,e)}setUserProperties(e){u(this,Ke,ai).call(this,{user_properties:e}),console.log(`Firebase Analytics] Updating user properties: ${JSON.stringify(e)}`)}}ms=new WeakMap,Ut=new WeakMap,gs=new WeakMap,Ft=new WeakMap,Gt=new WeakMap,X=new WeakMap,Ke=new WeakSet,oi=function(){if(clearTimeout(c(this,X).timeoutFlag),c(this,X).events.length===0){c(this,X).isAwaitingToBeSend=!1;return}u(this,Ke,ai).call(this,{events:c(this,X).events}),console.log(`[Firebase Analytics] ${c(this,X).events.length} event(s) sent to Firebase Analytics.`),c(this,X).events=[],c(this,X).isAwaitingToBeSend=!1},ai=async function(e){try{const t=c(this,gs)+`?api_secret=${c(this,ms)}&measurement_id=${c(this,Ut)}`,i=await fetch(t,{method:"POST",body:JSON.stringify({...e,user_id:c(this,Gt),client_id:c(this,Ft)}),headers:{"Content-Type":"application/json"}});if(!i.ok)throw new Error(`Failed to send data to Firebase Analytics. Status: ${i.status}.`);return i}catch(t){return console.error(t),null}};var yt;class jc{constructor(e){I(this,yt);A(this,"isInitialized",!1);T(this,yt,e)}async init(){if(this.isInitialized)return;const e=await fe.getPlugin(c(this,yt));if(!e)throw new Error(`The plugin "${c(this,yt)}" does not exist or its definition is missing.`);for(const t in e)this[t]=e[t];this.isInitialized=!0}}yt=new WeakMap;const Ae=Object.create(null);Ae.open="0";Ae.close="1";Ae.ping="2";Ae.pong="3";Ae.message="4";Ae.upgrade="5";Ae.noop="6";const ss=Object.create(null);Object.keys(Ae).forEach(s=>{ss[Ae[s]]=s});const ci={type:"error",data:"parser error"},or=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",ar=typeof ArrayBuffer=="function",cr=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer,Ni=({type:s,data:e},t,i)=>or&&e instanceof Blob?t?i(e):un(e,i):ar&&(e instanceof ArrayBuffer||cr(e))?t?i(e):un(new Blob([e]),i):i(Ae[s]+(e||"")),un=(s,e)=>{const t=new FileReader;return t.onload=function(){const i=t.result.split(",")[1];e("b"+(i||""))},t.readAsDataURL(s)};function dn(s){return s instanceof Uint8Array?s:s instanceof ArrayBuffer?new Uint8Array(s):new Uint8Array(s.buffer,s.byteOffset,s.byteLength)}let Ms;function Hc(s,e){if(or&&s.data instanceof Blob)return s.data.arrayBuffer().then(dn).then(e);if(ar&&(s.data instanceof ArrayBuffer||cr(s.data)))return e(dn(s.data));Ni(s,!1,t=>{Ms||(Ms=new TextEncoder),e(Ms.encode(t))})}const fn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Dt=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let s=0;s<fn.length;s++)Dt[fn.charCodeAt(s)]=s;const Wc=s=>{let e=s.length*.75,t=s.length,i,n=0,r,o,a,l;s[s.length-1]==="="&&(e--,s[s.length-2]==="="&&e--);const h=new ArrayBuffer(e),d=new Uint8Array(h);for(i=0;i<t;i+=4)r=Dt[s.charCodeAt(i)],o=Dt[s.charCodeAt(i+1)],a=Dt[s.charCodeAt(i+2)],l=Dt[s.charCodeAt(i+3)],d[n++]=r<<2|o>>4,d[n++]=(o&15)<<4|a>>2,d[n++]=(a&3)<<6|l&63;return h},Vc=typeof ArrayBuffer=="function",Pi=(s,e)=>{if(typeof s!="string")return{type:"message",data:lr(s,e)};const t=s.charAt(0);return t==="b"?{type:"message",data:zc(s.substring(1),e)}:ss[t]?s.length>1?{type:ss[t],data:s.substring(1)}:{type:ss[t]}:ci},zc=(s,e)=>{if(Vc){const t=Wc(s);return lr(t,e)}else return{base64:!0,data:s}},lr=(s,e)=>{switch(e){case"blob":return s instanceof Blob?s:new Blob([s]);case"arraybuffer":default:return s instanceof ArrayBuffer?s:s.buffer}},hr="",Jc=(s,e)=>{const t=s.length,i=new Array(t);let n=0;s.forEach((r,o)=>{Ni(r,!1,a=>{i[o]=a,++n===t&&e(i.join(hr))})})},qc=(s,e)=>{const t=s.split(hr),i=[];for(let n=0;n<t.length;n++){const r=Pi(t[n],e);if(i.push(r),r.type==="error")break}return i};function Kc(){return new TransformStream({transform(s,e){Hc(s,t=>{const i=t.length;let n;if(i<126)n=new Uint8Array(1),new DataView(n.buffer).setUint8(0,i);else if(i<65536){n=new Uint8Array(3);const r=new DataView(n.buffer);r.setUint8(0,126),r.setUint16(1,i)}else{n=new Uint8Array(9);const r=new DataView(n.buffer);r.setUint8(0,127),r.setBigUint64(1,BigInt(i))}s.data&&typeof s.data!="string"&&(n[0]|=128),e.enqueue(n),e.enqueue(t)})}})}let Bs;function Yt(s){return s.reduce((e,t)=>e+t.length,0)}function Qt(s,e){if(s[0].length===e)return s.shift();const t=new Uint8Array(e);let i=0;for(let n=0;n<e;n++)t[n]=s[0][i++],i===s[0].length&&(s.shift(),i=0);return s.length&&i<s[0].length&&(s[0]=s[0].slice(i)),t}function Xc(s,e){Bs||(Bs=new TextDecoder);const t=[];let i=0,n=-1,r=!1;return new TransformStream({transform(o,a){for(t.push(o);;){if(i===0){if(Yt(t)<1)break;const l=Qt(t,1);r=(l[0]&128)===128,n=l[0]&127,n<126?i=3:n===126?i=1:i=2}else if(i===1){if(Yt(t)<2)break;const l=Qt(t,2);n=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),i=3}else if(i===2){if(Yt(t)<8)break;const l=Qt(t,8),h=new DataView(l.buffer,l.byteOffset,l.length),d=h.getUint32(0);if(d>Math.pow(2,21)-1){a.enqueue(ci);break}n=d*Math.pow(2,32)+h.getUint32(4),i=3}else{if(Yt(t)<n)break;const l=Qt(t,n);a.enqueue(Pi(r?l:Bs.decode(l),e)),i=0}if(n===0||n>s){a.enqueue(ci);break}}}})}const ur=4;function W(s){if(s)return Yc(s)}function Yc(s){for(var e in W.prototype)s[e]=W.prototype[e];return s}W.prototype.on=W.prototype.addEventListener=function(s,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+s]=this._callbacks["$"+s]||[]).push(e),this};W.prototype.once=function(s,e){function t(){this.off(s,t),e.apply(this,arguments)}return t.fn=e,this.on(s,t),this};W.prototype.off=W.prototype.removeListener=W.prototype.removeAllListeners=W.prototype.removeEventListener=function(s,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+s];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+s],this;for(var i,n=0;n<t.length;n++)if(i=t[n],i===e||i.fn===e){t.splice(n,1);break}return t.length===0&&delete this._callbacks["$"+s],this};W.prototype.emit=function(s){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+s],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(t){t=t.slice(0);for(var i=0,n=t.length;i<n;++i)t[i].apply(this,e)}return this};W.prototype.emitReserved=W.prototype.emit;W.prototype.listeners=function(s){return this._callbacks=this._callbacks||{},this._callbacks["$"+s]||[]};W.prototype.hasListeners=function(s){return!!this.listeners(s).length};const bs=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),he=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Qc="arraybuffer";function dr(s,...e){return e.reduce((t,i)=>(s.hasOwnProperty(i)&&(t[i]=s[i]),t),{})}const Zc=he.setTimeout,el=he.clearTimeout;function vs(s,e){e.useNativeTimers?(s.setTimeoutFn=Zc.bind(he),s.clearTimeoutFn=el.bind(he)):(s.setTimeoutFn=he.setTimeout.bind(he),s.clearTimeoutFn=he.clearTimeout.bind(he))}const tl=1.33;function sl(s){return typeof s=="string"?il(s):Math.ceil((s.byteLength||s.size)*tl)}function il(s){let e=0,t=0;for(let i=0,n=s.length;i<n;i++)e=s.charCodeAt(i),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(i++,t+=4);return t}function fr(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function nl(s){let e="";for(let t in s)s.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(s[t]));return e}function rl(s){let e={},t=s.split("&");for(let i=0,n=t.length;i<n;i++){let r=t[i].split("=");e[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return e}class ol extends Error{constructor(e,t,i){super(e),this.description=t,this.context=i,this.type="TransportError"}}class Oi extends W{constructor(e){super(),this.writable=!1,vs(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,i){return super.emitReserved("error",new ol(e,t,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=Pi(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=nl(e);return t.length?"?"+t:""}}class al extends Oi{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let i=0;this._polling&&(i++,this.once("pollComplete",function(){--i||t()})),this.writable||(i++,this.once("drain",function(){--i||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};qc(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,Jc(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=fr()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let pr=!1;try{pr=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const cl=pr;function ll(){}class hl extends al{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let i=location.port;i||(i=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||i!==e.port}}doWrite(e,t){const i=this.request({method:"POST",data:e});i.on("success",t),i.on("error",(n,r)=>{this.onError("xhr post error",n,r)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,i)=>{this.onError("xhr poll error",t,i)}),this.pollXhr=e}}class Te extends W{constructor(e,t,i){super(),this.createRequest=e,vs(this,i),this._opts=i,this._method=i.method||"GET",this._uri=t,this._data=i.data!==void 0?i.data:null,this._create()}_create(){var e;const t=dr(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const i=this._xhr=this.createRequest(t);try{i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let n in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(n)&&i.setRequestHeader(n,this._opts.extraHeaders[n])}}catch{}if(this._method==="POST")try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{i.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=()=>{var n;i.readyState===3&&((n=this._opts.cookieJar)===null||n===void 0||n.parseCookies(i.getResponseHeader("set-cookie"))),i.readyState===4&&(i.status===200||i.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof i.status=="number"?i.status:0)},0))},i.send(this._data)}catch(n){this.setTimeoutFn(()=>{this._onError(n)},0);return}typeof document<"u"&&(this._index=Te.requestsCount++,Te.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=ll,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Te.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Te.requestsCount=0;Te.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",pn);else if(typeof addEventListener=="function"){const s="onpagehide"in he?"pagehide":"unload";addEventListener(s,pn,!1)}}function pn(){for(let s in Te.requests)Te.requests.hasOwnProperty(s)&&Te.requests[s].abort()}const ul=function(){const s=mr({xdomain:!1});return s&&s.responseType!==null}();class dl extends hl{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=ul&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Te(mr,this.uri(),e)}}function mr(s){const e=s.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||cl))return new XMLHttpRequest}catch{}if(!e)try{return new he[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const gr=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class fl extends Oi{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,i=gr?{}:dr(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,i)}catch(n){return this.emitReserved("error",n)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const i=e[t],n=t===e.length-1;Ni(i,this.supportsBinary,r=>{try{this.doWrite(i,r)}catch{}n&&bs(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=fr()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const $s=he.WebSocket||he.MozWebSocket;class pl extends fl{createSocket(e,t,i){return gr?new $s(e,t,i):t?new $s(e,t):new $s(e)}doWrite(e,t){this.ws.send(t)}}class ml extends Oi{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=Xc(Number.MAX_SAFE_INTEGER,this.socket.binaryType),i=e.readable.pipeThrough(t).getReader(),n=Kc();n.readable.pipeTo(e.writable),this._writer=n.writable.getWriter();const r=()=>{i.read().then(({done:a,value:l})=>{a||(this.onPacket(l),r())}).catch(a=>{})};r();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const i=e[t],n=t===e.length-1;this._writer.write(i).then(()=>{n&&bs(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const gl={websocket:pl,webtransport:ml,polling:dl},wl=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,yl=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function li(s){if(s.length>8e3)throw"URI too long";const e=s,t=s.indexOf("["),i=s.indexOf("]");t!=-1&&i!=-1&&(s=s.substring(0,t)+s.substring(t,i).replace(/:/g,";")+s.substring(i,s.length));let n=wl.exec(s||""),r={},o=14;for(;o--;)r[yl[o]]=n[o]||"";return t!=-1&&i!=-1&&(r.source=e,r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":"),r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":"),r.ipv6uri=!0),r.pathNames=Sl(r,r.path),r.queryKey=bl(r,r.query),r}function Sl(s,e){const t=/\/{2,9}/g,i=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&i.splice(0,1),e.slice(-1)=="/"&&i.splice(i.length-1,1),i}function bl(s,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,n,r){n&&(t[n]=r)}),t}const hi=typeof addEventListener=="function"&&typeof removeEventListener=="function",is=[];hi&&addEventListener("offline",()=>{is.forEach(s=>s())},!1);class Je extends W{constructor(e,t){if(super(),this.binaryType=Qc,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const i=li(e);t.hostname=i.host,t.secure=i.protocol==="https"||i.protocol==="wss",t.port=i.port,i.query&&(t.query=i.query)}else t.host&&(t.hostname=li(t.host).host);vs(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(i=>{const n=i.prototype.name;this.transports.push(n),this._transportsByName[n]=i}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=rl(this.opts.query)),hi&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},is.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=ur,t.transport=e,this.id&&(t.sid=this.id);const i=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](i)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Je.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",Je.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let i=0;i<this.writeBuffer.length;i++){const n=this.writeBuffer[i].data;if(n&&(t+=sl(n)),i>0&&t>this._maxPayload)return this.writeBuffer.slice(0,i);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,bs(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,i){return this._sendPacket("message",e,t,i),this}send(e,t,i){return this._sendPacket("message",e,t,i),this}_sendPacket(e,t,i,n){if(typeof t=="function"&&(n=t,t=void 0),typeof i=="function"&&(n=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;const r={type:e,data:t,options:i};this.emitReserved("packetCreate",r),this.writeBuffer.push(r),n&&this.once("flush",n),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},i=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():e()}):this.upgrading?i():e()),this}_onError(e){if(Je.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),hi&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const i=is.indexOf(this._offlineEventListener);i!==-1&&is.splice(i,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}Je.protocol=ur;class vl extends Je{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),i=!1;Je.priorWebsocketSuccess=!1;const n=()=>{i||(t.send([{type:"ping",data:"probe"}]),t.once("packet",p=>{if(!i)if(p.type==="pong"&&p.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Je.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(d(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const f=new Error("probe error");f.transport=t.name,this.emitReserved("upgradeError",f)}}))};function r(){i||(i=!0,d(),t.close(),t=null)}const o=p=>{const f=new Error("probe error: "+p);f.transport=t.name,r(),this.emitReserved("upgradeError",f)};function a(){o("transport closed")}function l(){o("socket closed")}function h(p){t&&p.name!==t.name&&r()}const d=()=>{t.removeListener("open",n),t.removeListener("error",o),t.removeListener("close",a),this.off("close",l),this.off("upgrading",h)};t.once("open",n),t.once("error",o),t.once("close",a),this.once("close",l),this.once("upgrading",h),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{i||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let i=0;i<e.length;i++)~this.transports.indexOf(e[i])&&t.push(e[i]);return t}}let _l=class extends vl{constructor(e,t={}){const i=typeof e=="object"?e:t;(!i.transports||i.transports&&typeof i.transports[0]=="string")&&(i.transports=(i.transports||["polling","websocket","webtransport"]).map(n=>gl[n]).filter(n=>!!n)),super(e,i)}};function Il(s,e="",t){let i=s;t=t||typeof location<"u"&&location,s==null&&(s=t.protocol+"//"+t.host),typeof s=="string"&&(s.charAt(0)==="/"&&(s.charAt(1)==="/"?s=t.protocol+s:s=t.host+s),/^(https?|wss?):\/\//.test(s)||(typeof t<"u"?s=t.protocol+"//"+s:s="https://"+s),i=li(s)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const r=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+r+":"+i.port+e,i.href=i.protocol+"://"+r+(t&&t.port===i.port?"":":"+i.port),i}const El=typeof ArrayBuffer=="function",Tl=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s.buffer instanceof ArrayBuffer,wr=Object.prototype.toString,Al=typeof Blob=="function"||typeof Blob<"u"&&wr.call(Blob)==="[object BlobConstructor]",Cl=typeof File=="function"||typeof File<"u"&&wr.call(File)==="[object FileConstructor]";function Di(s){return El&&(s instanceof ArrayBuffer||Tl(s))||Al&&s instanceof Blob||Cl&&s instanceof File}function ns(s,e){if(!s||typeof s!="object")return!1;if(Array.isArray(s)){for(let t=0,i=s.length;t<i;t++)if(ns(s[t]))return!0;return!1}if(Di(s))return!0;if(s.toJSON&&typeof s.toJSON=="function"&&arguments.length===1)return ns(s.toJSON(),!0);for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t)&&ns(s[t]))return!0;return!1}function kl(s){const e=[],t=s.data,i=s;return i.data=ui(t,e),i.attachments=e.length,{packet:i,buffers:e}}function ui(s,e){if(!s)return s;if(Di(s)){const t={_placeholder:!0,num:e.length};return e.push(s),t}else if(Array.isArray(s)){const t=new Array(s.length);for(let i=0;i<s.length;i++)t[i]=ui(s[i],e);return t}else if(typeof s=="object"&&!(s instanceof Date)){const t={};for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=ui(s[i],e));return t}return s}function Rl(s,e){return s.data=di(s.data,e),delete s.attachments,s}function di(s,e){if(!s)return s;if(s&&s._placeholder===!0){if(typeof s.num=="number"&&s.num>=0&&s.num<e.length)return e[s.num];throw new Error("illegal attachments")}else if(Array.isArray(s))for(let t=0;t<s.length;t++)s[t]=di(s[t],e);else if(typeof s=="object")for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&(s[t]=di(s[t],e));return s}const Nl=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Pl=5;var P;(function(s){s[s.CONNECT=0]="CONNECT",s[s.DISCONNECT=1]="DISCONNECT",s[s.EVENT=2]="EVENT",s[s.ACK=3]="ACK",s[s.CONNECT_ERROR=4]="CONNECT_ERROR",s[s.BINARY_EVENT=5]="BINARY_EVENT",s[s.BINARY_ACK=6]="BINARY_ACK"})(P||(P={}));class Ol{constructor(e){this.replacer=e}encode(e){return(e.type===P.EVENT||e.type===P.ACK)&&ns(e)?this.encodeAsBinary({type:e.type===P.EVENT?P.BINARY_EVENT:P.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===P.BINARY_EVENT||e.type===P.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=kl(e),i=this.encodeAsString(t.packet),n=t.buffers;return n.unshift(i),n}}function mn(s){return Object.prototype.toString.call(s)==="[object Object]"}class Li extends W{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const i=t.type===P.BINARY_EVENT;i||t.type===P.BINARY_ACK?(t.type=i?P.EVENT:P.ACK,this.reconstructor=new Dl(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(Di(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const i={type:Number(e.charAt(0))};if(P[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===P.BINARY_EVENT||i.type===P.BINARY_ACK){const r=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const o=e.substring(r,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");i.attachments=Number(o)}if(e.charAt(t+1)==="/"){const r=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););i.nsp=e.substring(r,t)}else i.nsp="/";const n=e.charAt(t+1);if(n!==""&&Number(n)==n){const r=t+1;for(;++t;){const o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}i.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=this.tryParse(e.substr(t));if(Li.isPayloadValid(i.type,r))i.data=r;else throw new Error("invalid payload")}return i}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case P.CONNECT:return mn(t);case P.DISCONNECT:return t===void 0;case P.CONNECT_ERROR:return typeof t=="string"||mn(t);case P.EVENT:case P.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&Nl.indexOf(t[0])===-1);case P.ACK:case P.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Dl{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=Rl(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Ll=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Li,Encoder:Ol,get PacketType(){return P},protocol:Pl},Symbol.toStringTag,{value:"Module"}));function ge(s,e,t){return s.on(e,t),function(){s.off(e,t)}}const Ml=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class yr extends W{constructor(e,t,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[ge(e,"open",this.onopen.bind(this)),ge(e,"packet",this.onpacket.bind(this)),ge(e,"error",this.onerror.bind(this)),ge(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var i,n,r;if(Ml.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const o={type:P.EVENT,data:t};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const d=this.ids++,p=t.pop();this._registerAckCallback(d,p),o.id=d}const a=(n=(i=this.io.engine)===null||i===void 0?void 0:i.transport)===null||n===void 0?void 0:n.writable,l=this.connected&&!(!((r=this.io.engine)===null||r===void 0)&&r._hasPingExpired());return this.flags.volatile&&!a||(l?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,t){var i;const n=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(n===void 0){this.acks[e]=t;return}const r=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===e&&this.sendBuffer.splice(a,1);t.call(this,new Error("operation has timed out"))},n),o=(...a)=>{this.io.clearTimeoutFn(r),t.apply(this,a)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((i,n)=>{const r=(o,a)=>o?n(o):i(a);r.withError=!0,t.push(r),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const i={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((n,...r)=>i!==this._queue[0]?void 0:(n!==null?i.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(n)):(this._queue.shift(),t&&t(null,...r)),i.pending=!1,this._drainQueue())),this._queue.push(i),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:P.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(i=>String(i.id)===e)){const i=this.acks[e];delete this.acks[e],i.withError&&i.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case P.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case P.EVENT:case P.BINARY_EVENT:this.onevent(e);break;case P.ACK:case P.BINARY_ACK:this.onack(e);break;case P.DISCONNECT:this.ondisconnect();break;case P.CONNECT_ERROR:this.destroy();const i=new Error(e.data.message);i.data=e.data.data,this.emitReserved("connect_error",i);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const i of t)i.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let i=!1;return function(...n){i||(i=!0,t.packet({type:P.ACK,id:e,data:n}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:P.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const i of t)i.apply(this,e.data)}}}function At(s){s=s||{},this.ms=s.min||100,this.max=s.max||1e4,this.factor=s.factor||2,this.jitter=s.jitter>0&&s.jitter<=1?s.jitter:0,this.attempts=0}At.prototype.duration=function(){var s=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*s);s=Math.floor(e*10)&1?s+t:s-t}return Math.min(s,this.max)|0};At.prototype.reset=function(){this.attempts=0};At.prototype.setMin=function(s){this.ms=s};At.prototype.setMax=function(s){this.max=s};At.prototype.setJitter=function(s){this.jitter=s};class fi extends W{constructor(e,t){var i;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,vs(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((i=t.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new At({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const n=t.parser||Ll;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new _l(this.uri,this.opts);const t=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const n=ge(t,"open",function(){i.onopen(),e&&e()}),r=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),e?e(a):this.maybeReconnectOnOpen()},o=ge(t,"error",r);if(this._timeout!==!1){const a=this._timeout,l=this.setTimeoutFn(()=>{n(),r(new Error("timeout")),t.close()},a);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(n),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(ge(e,"ping",this.onping.bind(this)),ge(e,"data",this.ondata.bind(this)),ge(e,"error",this.onerror.bind(this)),ge(e,"close",this.onclose.bind(this)),ge(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){bs(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let i=this.nsps[e];return i?this._autoConnect&&!i.active&&i.connect():(i=new yr(this,e,t),this.nsps[e]=i),i}_destroy(e){const t=Object.keys(this.nsps);for(const i of t)if(this.nsps[i].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let i=0;i<t.length;i++)this.engine.write(t[i],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var i;this.cleanup(),(i=this.engine)===null||i===void 0||i.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(n=>{n?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",n)):e.onreconnect()}))},t);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const kt={};function rs(s,e){typeof s=="object"&&(e=s,s=void 0),e=e||{};const t=Il(s,e.path||"/socket.io"),i=t.source,n=t.id,r=t.path,o=kt[n]&&r in kt[n].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let l;return a?l=new fi(i,e):(kt[n]||(kt[n]=new fi(i,e)),l=kt[n]),t.query&&!e.query&&(e.query=t.queryKey),l.socket(t.path,e)}Object.assign(rs,{Manager:fi,Socket:yr,io:rs,connect:rs});var nt,Q,j,ws,ue,pi,mi,Sr,br;class Bl{constructor(e){I(this,ue);I(this,nt);I(this,Q);I(this,j,{});I(this,ws,3);T(this,nt,e)}subscribe(e,t,i,n=null){if(!i||!i.onStatusUpdate||!i.onNewEvent){console.error("[SocketIO] Some event listeners are missing.");return}c(this,j)[e]={onStatusUpdate:i.onStatusUpdate,onNewEvent:i.onNewEvent,attributes:t,subscribed:!1},u(this,ue,Sr).call(this,n)}unsubscribe(e){if(!e||e==="all"){for(const t in c(this,j))this.unsubscribe(t);return}!c(this,Q)||!c(this,j)[e]||(console.log(`[SocketIO] Unsubscribing from event ${e}.`),c(this,j)[e].onStatusUpdate("disconnected"),c(this,Q).off(e),c(this,Q).emit("unsubscribe",{eventName:e}),delete c(this,j)[e],Object.keys(c(this,j)).length===0&&u(this,ue,br).call(this))}}nt=new WeakMap,Q=new WeakMap,j=new WeakMap,ws=new WeakMap,ue=new WeakSet,pi=function(){return Object.keys(c(this,j)).filter(e=>!c(this,j)[e].subscribed)},mi=function(){const e=u(this,ue,pi).call(this);for(const t of e)c(this,Q).emit("subscribe",{eventName:t,attributes:c(this,j)[t].attributes}),c(this,j)[t].subscribed=!0,c(this,j)[t].onStatusUpdate("connected")},Sr=function(e){if(c(this,Q)){u(this,ue,mi).call(this);return}T(this,Q,rs(c(this,nt),{transports:["websocket","polling"],rememberUpgrade:!0,query:e,reconnection:!0,reconnectionDelay:1e4,reconnectionAttempts:c(this,ws)})),console.log("[SocketIO] Establishing the WebSocket connection...");const t=u(this,ue,pi).call(this);for(const i of t)c(this,j)[i].onStatusUpdate("connecting");c(this,Q).on("connect",()=>{const i=c(this,Q).io.engine;console.log(`[SocketIO] The WebSocket connection was established. The current engine is "${i.transport.name}".`),u(this,ue,mi).call(this)}),c(this,Q).on("connect_error",()=>{M.notify(new Error(`[SocketIO] Failed to connect to ${c(this,nt)}.`));for(const i in c(this,j))c(this,j)[i].onStatusUpdate("failed")}),c(this,Q).onAny((i,n)=>{const r=i.replace("subs.","");console.log(`[SocketIO] Message received: ${JSON.stringify({eventName:r,message:n},null,"	")}`),typeof n=="string"&&(n=JSON.parse(n)),c(this,j)[r].onNewEvent({eventName:r,payload:n&&n.payload?n.payload:n})}),c(this,Q).on("disconnect",i=>{console.warn(`[SocketIO] The WebSocket connection was lost. Reason: ${i}.`);for(const n in c(this,j))c(this,j)[n].onStatusUpdate("disconnected")})},br=function(){c(this,Q)&&(console.log(`[SocketIO] Disconnecting from ${c(this,nt)}.`),c(this,Q).disconnect())};class $l{constructor(){A(this,"onNewEvent",new EventTarget);A(this,"onInfoUpdate",new EventTarget);A(this,"onError",new EventTarget)}}var jt,Ht,rt,ot,le,J,pe,Z,Fe,L,vr,_r,Ir,be,ve;class xl{constructor(){I(this,L);I(this,jt,`${Ee.paths.localAppData}\\Riot Games\\Riot Client\\Config\\lockfile`);I(this,Ht,`${Ee.paths.localAppData}\\VALORANT\\Saved\\Logs\\ShooterGame.log`);I(this,rt);I(this,ot);I(this,le,btoa(JSON.stringify({platformType:"PC",platformOS:"Windows",platformOSVersion:"10.0.19044.1.256.64bit",platformChipset:"Unknown"})));I(this,J);I(this,pe);I(this,Z);I(this,Fe)}resetConfig(){T(this,rt,null),T(this,ot,null),T(this,J,null),T(this,pe,null),T(this,Z,null),T(this,Fe,null)}async fetchGameContent(){try{const{accessToken:e,token:t}=await u(this,L,be).call(this),i=`https://shared.${c(this,Z)}.a.pvp.net/content-service/v3/content`,n={method:"GET",headers:{Authorization:`Bearer ${e}`,"X-Riot-Entitlements-JWT":t,"X-Riot-ClientPlatform":c(this,le),"X-Riot-ClientVersion":c(this,J)}};console.log(`[Riot Client Service] ${n.method} ${i}`);const r=await fetch(i,n);if(r.ok)return await r.json();{const o=await u(this,L,ve).call(this,r);throw new Error(`[Riot Client Service] Failed to fetch the list of seasons and events. Response: ${o}.`)}}catch(e){return console.error(e),M.notify(e),null}}async fetchPartyId(){try{const{puuid:e,accessToken:t,token:i}=await u(this,L,be).call(this),n=`https://glz-${c(this,pe)}-1.${c(this,Z)}.a.pvp.net/parties/v1/players/${e}`,r={method:"GET",headers:{Authorization:`Bearer ${t}`,"X-Riot-Entitlements-JWT":i,"X-Riot-ClientPlatform":c(this,le),"X-Riot-ClientVersion":c(this,J)}};console.log(`[Riot Client Service] ${r.method} ${n}`);const o=await fetch(n,r);if(o.ok)return(await o.json()).CurrentPartyID;{const a=await u(this,L,ve).call(this,o);throw new Error(`[Riot Client Service] Failed to fetch the party ID for the current user. PUUID: "${e}". Response: ${a}.`)}}catch(e){return console.error(e),M.notify(e),null}}async fetchPartyInfo(e){try{const{accessToken:t,token:i}=await u(this,L,be).call(this),n=`https://glz-${c(this,pe)}-1.${c(this,Z)}.a.pvp.net/parties/v1/parties/${e}`,r={method:"GET",headers:{Authorization:`Bearer ${t}`,"X-Riot-Entitlements-JWT":i,"X-Riot-ClientPlatform":c(this,le),"X-Riot-ClientVersion":c(this,J)}};console.log(`[Riot Client Service] ${r.method} ${n}`);const o=await fetch(n,r);if(o.ok)return await o.json();{const a=await u(this,L,ve).call(this,o);throw new Error(`[Riot Client Service] Failed to fetch the party information. Party ID: "${e}". Response: ${a}.`)}}catch(t){return console.error(t),M.notify(t),null}}async fetchActiveMatchId(e){try{const{puuid:t,accessToken:i,token:n}=await u(this,L,be).call(this),r=`https://glz-${c(this,pe)}-1.${c(this,Z)}.a.pvp.net/${e}/v1/players/${t}`,o={method:"GET",headers:{Authorization:`Bearer ${i}`,"X-Riot-Entitlements-JWT":n,"X-Riot-ClientPlatform":c(this,le),"X-Riot-ClientVersion":c(this,J)}};console.log(`[Riot Client Service] ${o.method} ${r}`);const a=await fetch(r,o);if(a.ok)return(await a.json()).MatchID;{const l=await u(this,L,ve).call(this,a);throw new Error(`[Riot Client Service] Failed to fetch the active match ID for the current user. PUUID: "${t}", stage ID: "${e}". Response: ${l}.`)}}catch(t){return console.error(t),M.notify(t),null}}async fetchActiveMatchInfo(e,t){try{const{accessToken:i,token:n}=await u(this,L,be).call(this),r=`https://glz-${c(this,pe)}-1.${c(this,Z)}.a.pvp.net/${e}/v1/matches/${t}`,o={method:"GET",headers:{Authorization:`Bearer ${i}`,"X-Riot-Entitlements-JWT":n,"X-Riot-ClientPlatform":c(this,le),"X-Riot-ClientVersion":c(this,J)}};console.log(`[Riot Client Service] ${o.method} ${r}`);const a=await fetch(r,o);if(a.ok)return await a.json();{const l=await u(this,L,ve).call(this,a);throw new Error(`[Riot Client Service] Failed to fetch the active match information. Match ID: "${t}", stage ID: "${e}". Response: ${l}.`)}}catch(i){return console.error(i),M.notify(i),null}}async fetchMatchDetails(e){try{const{accessToken:t,token:i}=await u(this,L,be).call(this),n=`https://pd.${c(this,Z)}.a.pvp.net/match-details/v1/matches/${e}`,r={method:"GET",headers:{Authorization:`Bearer ${t}`,"X-Riot-Entitlements-JWT":i,"X-Riot-ClientPlatform":c(this,le),"X-Riot-ClientVersion":c(this,J)}};console.log(`[Riot Client Service] ${r.method} ${n}`);const o=await fetch(n,r);if(o.ok)return await o.json();{const a=await u(this,L,ve).call(this,o);throw new Error(`[Riot Client Service] Failed to fetch the past match informations. Match ID: "${e}". Response: ${a}.`)}}catch(t){return console.error(t),M.notify(t),null}}async fetchMatchHistories(e,t=null,i=0,n=25){try{const{accessToken:r,token:o}=await u(this,L,be).call(this),a=new URLSearchParams;t!==null&&a.set("queue",t),i!==null&&a.set("startIndex",String(i)),n!==null&&a.set("endIndex",String(n));const l=e.map(d=>async()=>{try{const p=`https://pd.${c(this,Z)}.a.pvp.net/match-history/v1/history/${d}?${a}`,f={method:"GET",headers:{Authorization:`Bearer ${r}`,"X-Riot-Entitlements-JWT":o,"X-Riot-ClientPlatform":c(this,le),"X-Riot-ClientVersion":c(this,J)}};console.log(`[Riot Client Service] ${f.method} ${p}`);const w=await fetch(p,f);if(w.ok)return await w.json();{const y=await u(this,L,ve).call(this,w);throw new Error(`[Riot Client Service] Failed to fetch the player's match history. PUUID: "${d}", playlist ID: "${t}". Response: ${y}.`)}}catch(p){return console.error(p),M.notify(p),null}});return(await Promise.all(l.map(d=>d()))).filter(Boolean)}catch(r){return console.error(r),M.notify(r),null}}async fetchMatchmakingRatings(e){try{const{accessToken:t,token:i}=await u(this,L,be).call(this),n=e.map(o=>async()=>{try{const a=`https://pd.${c(this,Z)}.a.pvp.net/mmr/v1/players/${o}`,l={method:"GET",headers:{Authorization:`Bearer ${t}`,"X-Riot-Entitlements-JWT":i,"X-Riot-ClientPlatform":c(this,le),"X-Riot-ClientVersion":c(this,J)}};console.log(`[Riot Client Service] ${l.method} ${a}`);const h=await fetch(a,l);if(h.ok)return await h.json();{const d=await u(this,L,ve).call(this,h);throw new Error(`[Riot Client Service] Failed to fetch the player's matchmaking rating. PUUID: "${o}". Response: ${d}.`)}}catch(a){return console.error(a),M.notify(a),null}});return(await Promise.all(n.map(o=>o()))).filter(Boolean)}catch(t){return console.error(t),M.notify(t),null}}async fetchNames(e){try{const{accessToken:t,token:i}=await u(this,L,be).call(this),n=`https://pd.${c(this,Z)}.a.pvp.net/name-service/v2/players`,r={method:"PUT",headers:{Authorization:`Bearer ${t}`,"X-Riot-Entitlements-JWT":i,"X-Riot-ClientPlatform":c(this,le),"X-Riot-ClientVersion":c(this,J)},body:JSON.stringify(e)};console.log(`[Riot Client Service] ${r.method} ${n}`);const o=await fetch(n,r);if(o.ok)return await o.json();{const a=await u(this,L,ve).call(this,o);throw new Error(`[Riot Client Service] Failed to fetch names and taglines of players. PUUIDs: "${e.join('", "')}". Response: ${a}.`)}}catch(t){return console.error(t),M.notify(t),null}}}jt=new WeakMap,Ht=new WeakMap,rt=new WeakMap,ot=new WeakMap,le=new WeakMap,J=new WeakMap,pe=new WeakMap,Z=new WeakMap,Fe=new WeakMap,L=new WeakSet,vr=async function(){if(!await Ee.fileExists(c(this,jt)))throw new Error('[Riot Client Service] The "lockfile" file does not exist.');const t=await Ee.readFileContents(c(this,jt)),[i,n,r,o,a]=t.split(":");if(!r||!o)throw new Error('[Riot Client Service] The "lockfile" file does not contain a port or a password.');T(this,rt,Number(r)),T(this,ot,o)},_r=async function(){if(!await Ee.fileExists(c(this,Ht)))throw new Error('[Riot Client Service] The "ShooterGame.log" file does not exist.');const t=await Ee.readFileContents(c(this,Ht));if(!c(this,J)){const i=/CI server version: ([a-zA-Z0-9.-]+)/,n=t.match(i);if(!n)throw new Error('[Riot Client Service] The "ShooterGame.log" file does not contain the client version.');const[r,o]=n;o.includes("release")?T(this,J,o.replace(/(release-\d+\.\d+)(\S*)/,"$1-shipping$2")):T(this,J,o),console.log(`[Riot Client Service] The current client version is ${c(this,J)}.`)}if(!c(this,pe)||!c(this,Z)){const i=/glz-(\w+)-\d+\.(\w+)\.a\.pvp\.net/,n=t.match(i);if(!n)throw new Error('[Riot Client Service] The "ShooterGame.log" file does not contain a region or a shard.');const[r,o,a]=n;T(this,pe,o),T(this,Z,a)}},Ir=async function(){(!c(this,rt)||!c(this,ot))&&await u(this,L,vr).call(this),(!c(this,J)||!c(this,pe)||!c(this,Z))&&await u(this,L,_r).call(this);const e=`https://127.0.0.1:${c(this,rt)}/entitlements/v1/token`,t={method:"GET",headers:{Authorization:"Basic "+btoa(`riot:${c(this,ot)}`)}};console.log(`[Riot Client Service] ${t.method} ${e}`);const i=await fetch(e,t),n=await i.json();if(!i.ok)throw new Error(`[Riot Client Service] Failed to fetch the token and entitlement. Response: ${JSON.stringify(n)}.`);return{puuid:n.subject,accessToken:n.accessToken,token:n.token}},be=async function(){const e=Date.now();if(!c(this,Fe)||c(this,Fe).expiryDate<=e){const t=await u(this,L,Ir).call(this),i=JSON.parse(atob(t.accessToken.split(".")[1]));T(this,Fe,{...t,expiryDate:1e3*i.exp})}return c(this,Fe)},ve=async function(e){var i;if((i=e.headers.get("content-type"))==null?void 0:i.includes("application/json")){const n=await e.json();return n.errorCode==="BAD_CLAIMS"&&(this.resetConfig(),console.log("[Riot Client Service] The configuration has been reset due to bad claims.")),JSON.stringify(n)}else return await e.text()};const de=new xl;var Wt,St,Vt,zt,Ge,me,U,je,Ie,q,E,ft,x,Er,os,Tr,gi,as,Ar,Cr;class Ul extends $l{constructor(){super(...arguments);I(this,E);I(this,Wt,"valorant");I(this,St,!1);I(this,Vt,`${Ee.paths.localAppData}\\VALORANT\\Saved\\Logs\\ShooterGame.log`);I(this,zt,["me","game_info","match_info","premier_info","career_stats"]);I(this,Ge,null);I(this,me,{episodeId:null,actId:null,phaseId:null});I(this,U,{uuid:null,teamId:null});I(this,je,{uuid:null,puuids:[]});I(this,Ie,{uuid:null,playlistId:null});I(this,q,{isMatchmakingActive:!1,isPreGameFetched:!1,isCoreGameFetched:!1,isMatchActive:!1})}async setRequiredFeatures(t,i){if(c(this,St))return;t?t.includes("*")?T(this,Ge,c(this,zt)):T(this,Ge,t):T(this,Ge,[]),await Ee.fileExists(c(this,Vt))?(Ee.addFileListener(c(this,Wt),c(this,Vt),r=>{u(this,E,Er).call(this,r)},!0),T(this,St,!0),i({success:!0,supportedFeatures:c(this,Ge).filter(r=>c(this,zt).includes(r))})):i({success:!1,error:"The game logs file does not exist."})}unsetRequiredFeatures(){Ee.removeFileListener(c(this,Wt)),T(this,St,!1),T(this,Ge,null),de.resetConfig()}}Wt=new WeakMap,St=new WeakMap,Vt=new WeakMap,zt=new WeakMap,Ge=new WeakMap,me=new WeakMap,U=new WeakMap,je=new WeakMap,Ie=new WeakMap,q=new WeakMap,E=new WeakSet,ft=function(t){const i=new CustomEvent("event",{detail:t});this.onNewEvent.dispatchEvent(i)},x=function(t){const i=new CustomEvent("info-update",{detail:t});this.onInfoUpdate.dispatchEvent(i)},Er=async function(t){var i,n,r,o,a,l;if(t.includes("Broadcasting state changed to")){const h=/Broadcasting state changed to (\w+)/,d=t.match(h);if(!d)return;const[p,f]=d;if(["TransitionToPlatformFaulted","PlatformFaulted"].includes(f)||!["TransitionToMainMenu","MainMenu","TransitionToPregame","Pregame","TransitionToInGame","InGame"].includes(f))return;u(this,E,x).call(this,{feature:"game_info",info:{game_info:{screenId:f}}}),f==="InGame"&&(c(this,q).isMatchActive=!0,u(this,E,ft).call(this,{name:"match_start"}),u(this,E,os).call(this,c(this,Ie).playlistId)&&(u(this,E,x).call(this,{feature:"match_info",info:{match_info:{roundId:1}}}),u(this,E,x).call(this,{feature:"match_info",info:{match_info:{roundPhaseId:"shopping"}}})));return}if(t.includes("Loopstate changed from")){const h=/Loopstate changed from (\w+) to (\w+)/,d=t.match(h);if(!d)return;const[p,f,w]=d,y=u(this,E,Tr).call(this,w);if(["Invalid"].includes(y)||!["MainMenu","Pregame","InGame"].includes(y))return;c(this,me).phaseId=y,y==="MainMenu"?(c(this,q).isPreGameFetched=!1,c(this,q).isCoreGameFetched=!1,c(this,q).isMatchActive&&(c(this,U).teamId=null,c(this,q).isMatchActive=!1,u(this,E,ft).call(this,{name:"match_end"}))):(y==="Pregame"||y==="InGame")&&c(this,q).isMatchmakingActive&&(c(this,q).isMatchmakingActive=!1,u(this,E,ft).call(this,{name:"matchmaking_end",data:{reasonId:"match_found"}})),u(this,E,x).call(this,{feature:"game_info",info:{game_info:{phaseId:y}}});return}if(t.includes("LogMenuStackManager: Opening")){const h=/LogMenuStackManager: Opening (\w+)/,d=t.match(h);if(!d)return;const[p,f]=d;u(this,E,x).call(this,{feature:"game_info",info:{game_info:{menuId:f.replace(/(_C|_PC|V\d+)/g,"")}}});return}if(t.includes("Session_Heartbeat")&&t.includes("Response Code: [200]")){const h=/glz-(\w+)-\d+\.(\w+)\.a\.pvp\.net\/session\/v1\/sessions\/([0-9a-z-]+)\/heartbeat/,d=t.match(h);if(!d)return;const[p,f,w,y]=d;if(c(this,U).uuid&&c(this,U).uuid===y)return;const g=await de.fetchNames([y]),v=g==null?void 0:g.find(C=>C.Subject===y);if(!v)return;c(this,U).uuid=y,u(this,E,x).call(this,{feature:"me",info:{me:{playerId:y}}}),u(this,E,x).call(this,{feature:"me",info:{me:{regionId:f}}}),u(this,E,x).call(this,{feature:"me",info:{me:{playerName:`${v.GameName}#${v.TagLine}`}}});return}if((t.includes("Party_ChangeQueue")||t.includes("Party_MakePartyIntoCustomGame")||t.includes("Party_SetCustomGameSettings")||t.includes("Party_ConvertToDefault"))&&t.includes("Response Code: [200]")){const h=/\/parties\/v1\/parties\/([0-9a-z-]+)\/(queue|makecustomgame|customgamesettings|converttodefault)/,d=t.match(h);if(!d)return;const[p,f,w]=d,y=await de.fetchPartyInfo(f);if(y){const g=y.MatchmakingData,v=g.QueueID==="competitive",C=w==="makecustomgame"||w==="customgamesettings",Y=u(this,E,as).call(this,C?y.CustomGameData.Settings.Mode:g.QueueID,C);u(this,E,x).call(this,{feature:"game_info",info:{game_info:{playlistId:Y,isRanked:v,isCustom:C}}}),c(this,je).uuid=y.ID,c(this,je).puuids=y.Members.map(Ce=>Ce.Subject)}return}if(t.includes("Party_EnterMatchmakingQueue")&&t.includes("Response Code: [200]")){c(this,q).isMatchmakingActive=!0,u(this,E,ft).call(this,{name:"matchmaking_start"});return}if(t.includes("Party_LeaveMatchmakingQueue")&&t.includes("Response Code: [200]")){c(this,q).isMatchmakingActive=!1,u(this,E,ft).call(this,{name:"matchmaking_end",data:{reasonId:"cancelled"}});return}if((t.includes("Pregame_SelectCharacter")||t.includes("Pregame_LockCharacter"))&&t.includes("Response Code: [200]")){const h=/([a-z-]+)\/v1\/matches\/([0-9a-z-]+)\/(select|lock)\/([0-9a-z-]+)/,d=t.match(h);if(!d)return;const[p,f,w,y,g]=d;u(this,E,x).call(this,{feature:"me",info:{me:{agentId:u(this,E,gi).call(this,g),isLocked:y==="lock"}}});return}if((t.includes("Pregame_GetMatch")||t.includes("CoreGame_FetchMatch"))&&t.includes("Response Code: [200]")){if(c(this,me).phaseId==="MainMenu")return;const h=/\/([a-z-]+)\/v1\/matches\/([0-9a-z-]+)/,d=t.match(h),[p,f,w]=d;if(!["pregame","core-game"].includes(f))throw new Error(`[Valorant Events Provider] Unknown stage ID: "${f}".`);if(f==="pregame"){if(c(this,q).isPreGameFetched)return;c(this,q).isPreGameFetched=!0}else if(f==="core-game"){if(c(this,q).isCoreGameFetched)return;c(this,q).isCoreGameFetched=!0}const y=!c(this,Ie).uuid||c(this,Ie).uuid!==w;y&&(c(this,Ie).uuid=w,u(this,E,x).call(this,{feature:"match_info",info:{match_info:{matchId:w}}}));const g=await de.fetchActiveMatchInfo(f,w);if(!g){f==="pregame"?c(this,q).isPreGameFetched=!1:f==="core-game"&&(c(this,q).isCoreGameFetched=!1);return}const v=g.MatchmakingData||{QueueID:g.QueueID||"custom",IsRanked:g.IsRanked||!1},C=v.IsRanked,Y=v.QueueID==="custom",Ce=u(this,E,as).call(this,Y?g.Mode||g.ModeID:v.QueueID,Y);if(y&&(c(this,Ie).playlistId=Ce,u(this,E,x).call(this,{feature:"match_info",info:{match_info:{playlistId:Ce,isRanked:C,isCustom:Y}}}),u(this,E,x).call(this,{feature:"match_info",info:{match_info:{mapId:u(this,E,Ar).call(this,g.MapID.split("/").pop())}}})),f==="pregame"&&!g.AllyTeam)return;if(!c(this,me).episodeId||!c(this,me).actId){const D=await de.fetchGameContent();D!=null&&D.Seasons&&(c(this,me).episodeId=(i=D.Seasons.find(F=>F.Type==="episode"&&F.IsActive))==null?void 0:i.ID,c(this,me).actId=(n=D.Seasons.find(F=>F.Type==="act"&&F.IsActive))==null?void 0:n.ID)}g.AllyTeam?c(this,U).teamId=g.AllyTeam.TeamID:c(this,U).teamId||(c(this,U).teamId=(r=g.Players.find(D=>D.Subject===c(this,U).uuid))==null?void 0:r.TeamID);const oe=f==="pregame"?g.AllyTeam.Players:g.Players.filter(D=>D.TeamID!=="Neutral"&&!D.IsCoach).sort((D,F)=>c(this,U).teamId?D.TeamID===c(this,U).teamId&&F.TeamID!==c(this,U).teamId?-1:D.TeamID!==c(this,U).teamId&&F.TeamID===c(this,U).teamId?1:0:0);if((oe==null?void 0:oe.length)>0){const D=oe.map(G=>G.Subject),F=await de.fetchNames(D),V=c(this,me).actId?await de.fetchMatchmakingRatings(D):null;for(const[G,N]of oe.entries()){const $=F==null?void 0:F.find(Ct=>Ct.Subject===N.Subject),se=V==null?void 0:V.find(Ct=>Ct.Subject===N.Subject),Se=(l=(a=(o=se==null?void 0:se.QueueSkills)==null?void 0:o.competitive)==null?void 0:a.SeasonalInfoBySeasonID)==null?void 0:l[c(this,me).actId];u(this,E,x).call(this,{feature:"match_info",info:{match_info:{[`player_${G}`]:{playerId:N.Subject,playerName:$?`${$.GameName}#${$.TagLine}`:null,platformId:N.PlatformType,isLocal:N.Subject===c(this,U).uuid,isTeammate:f==="pregame"||N.Subject===c(this,U).uuid||N.TeamID===c(this,U).teamId&&Ce!=="deathmatch",isNameHidden:N.PlayerIdentity.Incognito,levelId:N.PlayerIdentity.AccountLevel,isLevelHidden:N.PlayerIdentity.HideAccountLevel,rankId:Se?Se.CompetitiveTier:null,rating:Se?100*Se.CompetitiveTier+Se.RankedRating:null,agentId:N.CharacterID?u(this,E,gi).call(this,N.CharacterID):null}}}})}if(f==="core-game")for(const[G,N]of oe.entries()){const $=V==null?void 0:V.find(se=>se.Subject===N.Subject);u(this,E,x).call(this,{feature:"career_stats",info:{career_stats:{[`player_${G}`]:{playerId:N.Subject,playlists:$!=null&&$.QueueSkills?Object.keys($.QueueSkills).reduce((se,Se)=>{if($.QueueSkills[Se].SeasonalInfoBySeasonID){const Ct=u(this,E,as).call(this,Se);se[Ct]={seasons:Object.keys($.QueueSkills[Se].SeasonalInfoBySeasonID).reduce((Ui,Fi)=>{const Ye=$.QueueSkills[Se].SeasonalInfoBySeasonID[Fi];return Ui[Fi]={rankId:Ye.CompetitiveTier,matchesWon:Ye.NumberOfWinsWithPlacements,matchesLost:Ye.NumberOfGames-Ye.NumberOfWinsWithPlacements,matchesPlayed:Ye.NumberOfGames,matchWinPct:100*Ye.NumberOfWinsWithPlacements/Ye.NumberOfGames||0},Ui},{})}}return se},{}):null}}}})}}if(f==="core-game"){const D=g.Players.filter(F=>F.TeamID==="Neutral");if(D.length>0){const F=D.map(G=>G.Subject),V=await de.fetchNames(F);for(const[G,N]of D.entries()){const $=V==null?void 0:V.find(se=>se.Subject===N.Subject);u(this,E,x).call(this,{feature:"match_info",info:{match_info:{[`observer_${G}`]:{playerId:N.Subject,playerName:$?`${$.GameName}#${$.TagLine}`:null,isLocal:N.Subject===c(this,U).uuid,isNameHidden:N.PlayerIdentity.Incognito,levelId:N.PlayerIdentity.AccountLevel}}}})}}}if(f==="pregame"&&Ce==="premier"){const D=[];for(const[G,N]of Object.values(g.RosterMetadata.RostersByPartyID).entries())N.Members.forEach($=>{D.push({Subject:$.Subject,RosterID:N.RosterID})}),u(this,E,x).call(this,{feature:"premier_info",info:{premier_info:{[`team_${G}`]:{teamId:N.RosterID,teamName:`${N.Name}#${N.Tag}`,isLocal:g.AllyTeam.Players.some($=>N.Members.some(se=>se.Subject===$.Subject))}}}});const F=D.map(G=>G.Subject),V=await de.fetchNames(F);for(const[G,N]of D.entries()){const $=V==null?void 0:V.find(se=>se.Subject===N.Subject);u(this,E,x).call(this,{feature:"premier_info",info:{premier_info:{[`player_${G}`]:{playerId:N.Subject,playerName:$?`${$.GameName}#${$.TagLine}`:null,isLocal:N.Subject===c(this,U).uuid,teamId:N.RosterID}}}})}}if(f==="core-game"&&!["npe","premier"].includes(Ce)&&(oe==null?void 0:oe.length)>0){const D={};for(const F of["Blue","Red"]){const V=oe.filter(G=>G.TeamID===F).map(G=>G.Subject);if(V.length>0){const G=await u(this,E,Cr).call(this,V);for(const N in G)D[N]=G[N]}}for(const[F,V]of Object.values(D).entries())u(this,E,x).call(this,{feature:"match_info",info:{match_info:{[`party_${F}`]:V}}})}return}if(t.includes("AShooterGameState::OnRoundEnded for round")){if(!u(this,E,os).call(this,c(this,Ie).playlistId))return;const d=/AShooterGameState::OnRoundEnded for round '(\d+)'/,p=t.match(d);if(!p)return;const f=Number(p[1])+2;u(this,E,x).call(this,{feature:"match_info",info:{match_info:{roundId:f}}});return}if(t.includes("Gameplay started at local time")){if(!u(this,E,os).call(this,c(this,Ie).playlistId))return;const d=/Gameplay started at local time (\d+\.\d+)/,p=t.match(d);if(!p)return;const f=parseFloat(p[1]);u(this,E,x).call(this,{feature:"match_info",info:{match_info:{roundPhaseId:f<1?"shopping":"combat"}}});return}if(t.includes("Winning Team:")&&(t.includes("Blue")||t.includes("Red"))){if(!c(this,U).teamId)return;const h=/Winning Team: '(\w+)'/,d=t.match(h);if(!d)return;const[p,f]=d;u(this,E,x).call(this,{feature:"match_info",info:{match_info:{resultId:c(this,U).teamId===f?"victory":"defeat"}}});return}},os=function(t){return["competitive","premier","unrated","swiftplay","spikerush","replication"].includes(t)},Tr=function(t){switch(t){case"INVALID":return"Invalid";case"MENUS":return"MainMenu";case"PREGAME":return"Pregame";case"INGAME":return"InGame";default:return t}},gi=function(t){switch(t==null?void 0:t.toLowerCase()){case"e370fa57-4757-3604-3648-499e1f642d3f":return"Aggrobot";case"dade69b4-4f5a-8528-247b-219e5a1facd6":return"BountyHunter";case"5f8d3a7f-467b-97f3-062c-13acf203c006":return"Breach";case"cc8b64c8-4b25-4ff9-6e7f-37b4da43d235":return"Cable";case"b444168c-4e35-8076-db47-ef9bf368f384":return"Cashew";case"f94c3b30-42be-e959-889c-5aa313dba261":return"Clay";case"22697a3d-45bf-8dd7-4fec-84a9e28c69d7":return"Deadeye";case"601dbbe7-43ce-be57-2a40-4abd24953621":return"Grenadier";case"6f2a04ca-43e0-be17-7f36-b3908627744d":return"Guide";case"117ed9e3-49f3-6512-3ccf-0cada7e3823b":return"Gumshoe";case"ded3520f-4264-bfed-162d-b080e2abccf9":return"Hunter_NPE";case"320b2a48-4d9b-a075-30f1-1f93a9b638fa":return"Hunter";case"1e58de9c-4950-5125-93e9-a0aee9f98746":return"Killjoy";case"95b78ed7-4637-86d9-7e41-71ba8c293152":return"Mage";case"707eab51-4836-f488-046a-cda6bf494859":return"Pandemic";case"eb93336a-449b-9c1b-0a54-a891f7921d69":return"Phoenix";case"41fb69c1-4189-7b37-f117-bcaf1e96f1bf":return"Rift";case"9f0d8ba9-4140-b941-57d3-a7ad57c6b417":return"Sarge";case"0e38b510-41a8-5780-5e8f-568b2a4f2d6c":return"Sequoia";case"1dbf2edd-4729-0984-3115-daa5eed44993":return"Smonk";case"bb2a4828-46eb-8cd1-e765-15848195d751":return"Sprinter";case"7f94d92c-4234-0a36-9646-3a87eb8b5c89":return"Stealth";case"569fdd95-4d10-43ab-ca70-79becc718b46":return"Thorne";case"a3bfb853-43b2-7238-a4f1-ad90e9e46bcc":return"Vampire";case"8e253930-4c05-31dd-1b6c-968525494517":return"Wraith";case"efba5359-4016-a1e5-7626-b1ae76895940":return"Nox";case"add6443a-41bd-e414-f6ad-e58d267f4e95":return"Wushu"}return t&&console.error(`[Valorant Events Provider] Unknown agent ID: "${t}".`),t},as=function(t,i=!1){if(t==="newmap")return"swiftplay";if(i){const n=t.split("/");switch(n[n.length-2]){case"Bomb":return"unrated";case"Swiftplay_EndOfRoundCredits":return"swiftplay";case"QuickBomb":return"spikerush";case"Deathmatch":return"deathmatch";case"HURM":return"team-deathmatch";case"GunGame":return"escalation";case"OneForAll":return"replication";case"SnowballFight":return"snowball";case"NewPlayerExperience":return"npe";case"NewNPEMode":return"npe";case"NPEV2":return"npe";case"ShootingRange":return"range";case"ExamplePlayerTestBot":return"range"}}else switch(t){case"competitive":return"competitive";case"premier":return"premier";case"unrated":return"unrated";case"swiftplay":return"swiftplay";case"spikerush":return"spikerush";case"deathmatch":return"deathmatch";case"hurm":return"team-deathmatch";case"ggteam":return"escalation";case"onefa":return"replication";case"snowball":return"snowball"}return t&&console.error(`[Valorant Events Provider] Unknown playlist ID: "${t}".`),t},Ar=function(t){switch(t){case"RangeV2":return"Range";case"NPEV2":return"Range";default:return t}},Cr=async function(t){const i=await de.fetchMatchHistories(t),n=i.reduce((o,a)=>{const l=a.History;for(const h of l){const d=h.MatchID;if(!o.some(p=>p.matchId===d)){const p=i.reduce((f,w)=>(w.History.some(g=>g.MatchID===d)&&f.push(w.Subject),f),[]);p.length>1&&(o.some(w=>p.every(y=>w.participantsIds.includes(y)))||o.push({matchId:d,participantsIds:p}))}}return o},[]),r={};c(this,je).uuid&&(r[c(this,je).uuid]=c(this,je).puuids);for(const o of n){const a=await de.fetchMatchDetails(o.matchId);if(a){const l=a.players.filter(h=>o.participantsIds.includes(h.subject));for(const h of l){const d=h.subject,p=h.partyId;r[p]||(r[p]=[]),r[p].includes(d)||r[p].push(d)}}}for(const o in r)r[o].length<=1&&delete r[o];return Object.entries(r).reduce((o,[a,l])=>{const h=Object.values(o).find(d=>d.some(p=>l.includes(p)));if(h)for(const d of l)h.includes(d)||h.push(d);else o[a]=l;return o},{})};const gn=["","Ich","Me","Yo","Moi","Aku","Giocatore","","","Ja","Eu","","","Ben","Ti",""];var O,Jt,qt,b,Ne,kr,cs,Rr,wi,yi,Nr,Si,ls,Lt,Pr,Or,hs,bi,Dr,Lr,Mr,xe;class Fl{constructor(){I(this,b);A(this,"me",{id:localStorage.id||null,nickname:localStorage.nickname||null,regionId:localStorage.regionId||null});A(this,"agent",{id:null,isLocked:!1});A(this,"stats",{kills:0,deaths:0,assists:0,headshots:0,headHits:0,bodyHits:0,legsHits:0,damageDealt:0,damageRecieved:0});A(this,"game",{episodeIndex:null,actIndex:null,phaseId:null,screenId:null});A(this,"matchmaking",{isActive:!1});A(this,"match",{id:null,isActive:!1,isRanked:!1,isCustom:!1,modeId:null,playlistId:null,isTeamBased:!1,isRoundBased:!1,mapId:null,resultId:null});A(this,"score",{wins:0,losses:0});A(this,"round",{id:1,sideId:null,phaseId:null});A(this,"rounds",[]);A(this,"players",{roster_0:null,roster_1:null,roster_2:null,roster_3:null,roster_4:null,roster_5:null,roster_6:null,roster_7:null,roster_8:null,roster_9:null,roster_10:null,roster_11:null});A(this,"teams",{team_0:null,team_1:null});I(this,O,{isMatchReset:!0,isFirstKillInRound:!0,isFirstDeathInRound:!0,isClutchSituation:!1,lastAliveTeammate:null,lastAliveOpponent:null});I(this,Jt,{matchmaking_start:()=>{this.matchmaking.isActive=!0},matchmaking_end:()=>{this.matchmaking.isActive=!1},match_start:()=>{this.match.isActive=!0,this.match.isRoundBased||u(this,b,hs).call(this);const e=Object.values(this.players).filter(Boolean);for(const t of e)t.duels||(t.duels=e.reduce((i,n)=>(i[n.id]={kills:0,deaths:0},i),{}))},match_end:()=>{this.match.isActive=!1},kill:e=>{u(this,b,Lt).call(this,"kills",Number(e))},death:e=>{u(this,b,Lt).call(this,"deaths",Number(e))},assist:e=>{u(this,b,Lt).call(this,"assists",Number(e))},headshot:e=>{u(this,b,Lt).call(this,"headshots",Number(e));const t=Object.values(this.players).filter(Boolean).find(i=>i.isLocal);t&&t.scoreboard.headshots++}});I(this,qt,{me:e=>{if(e.me.player_id){localStorage.id=this.me.id=e.me.player_id;return}if(e.me.playerId){localStorage.id=this.me.id=e.me.playerId;return}if(e.me.player_name){localStorage.nickname=this.me.nickname=e.me.player_name;return}if(e.me.playerName){localStorage.nickname=this.me.nickname=e.me.playerName;return}if(!e.me.region){if(e.me.regionId){localStorage.regionId=this.me.regionId=e.me.regionId;return}if(e.me.agent){const t=u(this,b,Ne).call(this,e.me.agent.replace("_PC_C",""));t&&(this.agent.id=t),this.agent.isLocked=!0;return}if(e.me.agentId){const t=u(this,b,Ne).call(this,e.me.agentId);t&&(this.agent.id=t),this.agent.isLocked=e.me.isLocked;return}}},game_info:e=>{if(e.game_info.phaseId){this.game.phaseId=e.game_info.phaseId,this.game.phaseId==="MainMenu"&&(c(this,O).isMatchReset=!1);return}if(e.game_info.screenId){this.game.screenId=e.game_info.screenId,(this.game.screenId==="TransitionToMainMenu"||this.game.screenId==="MainMenu")&&(c(this,O).isMatchReset=!1);return}if(e.game_info.scene){const t=e.game_info.scene;if(["Init","MainMenu","CharacterSelectPersistentLevel"].includes(t)){switch((t==="Init"||t==="MainMenu")&&(this.match.isActive=!1),t){case"Init":this.game.phaseId="MainMenu",this.game.screenId="TransitionToMainMenu";break;case"MainMenu":this.game.phaseId="MainMenu",this.game.screenId="MainMenu";break;case"CharacterSelectPersistentLevel":this.game.phaseId="Pregame",this.game.screenId="Pregame";break}this.game.phaseId==="MainMenu"&&(c(this,O).isMatchReset=!1)}else this.match.mapId=u(this,b,cs).call(this,t);return}if(e.game_info.state){const t=e.game_info.state;switch(t){case"WaitingToStart":this.game.phaseId="InGame",this.game.screenId="TransitionToInGame";break;case"InProgress":this.game.phaseId="InGame",this.game.screenId="InGame";break;case"WaitingPostMatch":this.game.phaseId="MainMenu",this.game.screenId="TransitionToMainMenu";break;default:console.error(`[Live Match Service] Unknown match state ID: "${t}".`)}this.game.phaseId==="MainMenu"&&(c(this,O).isMatchReset=!1);return}},match_info:e=>{var t,i;if(!e.match_info.pseudo_match_id){if(e.match_info.matchId){u(this,b,bi).call(this),this.match.id=e.match_info.matchId;return}if(e.match_info.game_mode){u(this,b,bi).call(this);const n=JSON.parse(e.match_info.game_mode);if(n.mode==="bomb"&&this.match.playlistId==="premier")return;this.match.isRanked=n.ranked==="1",this.match.isCustom=n.custom,n.mode==="bomb"?this.match.playlistId=this.match.isRanked?"competitive":"unrated":this.match.playlistId=u(this,b,Rr).call(this,n.mode),this.match.isTeamBased=u(this,b,wi).call(this,this.match.playlistId),this.match.isRoundBased=u(this,b,yi).call(this,this.match.playlistId);return}if(e.match_info.playlistId){this.match.isRanked=e.match_info.isRanked,this.match.isCustom=e.match_info.isCustom,this.match.playlistId=e.match_info.playlistId,this.match.isTeamBased=u(this,b,wi).call(this,this.match.playlistId),this.match.isRoundBased=u(this,b,yi).call(this,this.match.playlistId);return}if(e.match_info.map){this.match.mapId=u(this,b,cs).call(this,e.match_info.map);return}if(e.match_info.mapId){this.match.mapId=u(this,b,cs).call(this,e.match_info.mapId);return}if(e.match_info.round_number){if(!this.match.isRoundBased)return;this.round.id=Number(e.match_info.round_number),u(this,b,hs).call(this),this.round.id!==1&&u(this,b,Dr).call(this);return}if(e.match_info.team){if(!this.match.isRoundBased)return;this.round.sideId=e.match_info.team;const n=this.rounds.find(r=>r.id===this.round.id);n&&(n.sideId=this.round.sideId);return}if(e.match_info.round_phase){this.round.phaseId=e.match_info.round_phase;return}if(e.match_info.round_report){const n=JSON.parse(e.match_info.round_report),r=Number(n.headshot)+Number(n.final_headshot),o=Number(n.bodyshots),a=Number(n.legshots),l=Number(n.damage)+Number(n.ability_damage),h=Number(n.damage_received);this.match.isRoundBased?(this.stats.headHits+=r,this.stats.bodyHits+=o,this.stats.legsHits+=a,this.stats.damageDealt+=l,this.stats.damageRecieved+=h):(this.stats.headHits=r,this.stats.bodyHits=o,this.stats.legsHits=a,this.stats.damageDealt=l,this.stats.damageRecieved=h);return}if(e.match_info.score){if(!this.match.isRoundBased)return;const n=JSON.parse(e.match_info.score),r=this.rounds.find(o=>o.id===this.round.id);r&&((n.won>0||n.lost>0)&&(r.resultId=this.score.wins<n.won?"victory":"defeat"),c(this,O).isClutchSituation&&(r.resultId==="victory"&&c(this,O).lastAliveTeammate?c(this,O).lastAliveTeammate.scoreboard.clutches++:r.resultId==="defeat"&&c(this,O).lastAliveOpponent&&c(this,O).lastAliveOpponent.scoreboard.clutches++)),this.score.wins=n.won,this.score.losses=n.lost;return}if(e.match_info.match_outcome){this.match.resultId=e.match_info.match_outcome;return}if(e.match_info.resultId){this.match.resultId=e.match_info.resultId;return}if(e.match_info.kill_feed){const n=JSON.parse(e.match_info.kill_feed),r=Object.values(this.players).filter(Boolean),o=r.find(h=>h.isTeammate===n.is_attacker_teammate&&(h.visibleNickname===n.attacker||h.isLocal&&gn.includes(n.attacker)||h.agentId===u(this,b,Ne).call(this,n.attacker,!1))),a=r.find(h=>h.isTeammate===n.is_victim_teammate&&(h.visibleNickname===n.victim||h.isLocal&&gn.includes(n.victim)||h.agentId===u(this,b,Ne).call(this,n.victim,!1)));o||console.error(`[Live Match Service] Unknown attacker: "${n.attacker}".`),a||console.error(`[Live Match Service] Unknown victim: "${n.victim}".`),u(this,b,Nr).call(this,n.weapon);const l=n.headshot;if(this.match.playlistId==="escalation"){if(!["combat","end"].includes(this.round.phaseId))return;const h=[n.assist1,n.assist2,n.assist3,n.assist4].filter(Boolean).map(d=>{switch(d=d.replace(/^TX_Killfeed_|1$/g,""),d){case"Mage":d="Harbor";break}return d.toLowerCase()});if(o){o.scoreboard.kills++,l&&!o.isLocal&&o.scoreboard.headshots++;for(const d of h){const p=r.find(f=>f.isTeammate===o.isTeammate&&f.agentId===d);p&&p.scoreboard.assists++}}a&&(a.isAlive=!1,a.scoreboard.deaths++)}else o&&l&&!o.isLocal&&o.scoreboard.headshots++,a&&(a.isAlive=!1),u(this,b,Or).call(this,o,a);if(o&&a){if(!this.match.isRoundBased&&this.round.phaseId!=="combat")return;(t=o.duels)!=null&&t[a.id]&&o.duels[a.id].kills++,(i=a.duels)!=null&&i[o.id]&&a.duels[o.id].deaths++}return}for(const n in e.match_info){if(n.startsWith("player_")){const r=e.match_info[n],o=Number(n.replace("player_","")),a=r.playerId,l=r.playerName,h=r.agentId?u(this,b,Ne).call(this,r.agentId):null,d=!!r.agentId,p=r.isLocal,f=r.isTeammate,w=r.isNameHidden,y=r.isLevelHidden,g=r.levelId,v=u(this,b,Si).call(this,r.rankId),C=r.rating;p&&(localStorage.id=this.me.id=a,l&&(localStorage.nickname=this.me.nickname=l),h&&(this.agent.id=h),this.agent.isLocked=d),u(this,b,ls).call(this,"player",o,a,l,w,h,d,p,f,g,y,v,C);return}if(n.startsWith("roster_")){const r=JSON.parse(e.match_info[n]);if(!r||!r.player_id)return;const o=Number(n.replace("roster_","")),a=r.player_id,l=r.name?r.name.replace(" #","#"):null,h=r.character?u(this,b,Ne).call(this,r.character):null,d=r.locked,p=r.local,f=r.teammate||p,w=!l||l&&(!l.includes("#")||l.endsWith("#")),y=null,g=null,v=u(this,b,Si).call(this,r.rank),C=null;p&&(w||(localStorage.id=this.me.id=a,l&&(localStorage.nickname=this.me.nickname=l)),h&&(this.agent.id=h),this.agent.isLocked=d),u(this,b,ls).call(this,"roster",o,a,l,w,h,d,p,f,g,y,v,C);return}if(n.startsWith("scoreboard_")){if(this.match.playlistId==="escalation")return;const r=JSON.parse(e.match_info[n]);if(!r||!r.player_id||!r.name)return;const o=Number(n.replace("scoreboard_","")),a=r.player_id,l=r.name?r.name.replace(" #","#"):null,h=u(this,b,Ne).call(this,r.character),d=!0,p=r.is_local,f=r.teammate||p,w=l&&(!l.includes("#")||l.endsWith("#"));u(this,b,ls).call(this,"scoreboard",o,a,l,w,h,d,p,f,null,null,null,null);const Y=this.match.screenId==="TransitionToInGame"||r.alive,Ce=r.kills,oe=r.deaths,D=r.assists;u(this,b,Pr).call(this,a,Y,Ce,oe,D);return}if(n.startsWith("party_")){const r=e.match_info[n],o=Number(n.replace("party_",""));for(const a of r){const l=Object.values(this.players).filter(Boolean).find(h=>h.id===a);l&&(l.partyId=o+1)}return}}}},premier_info:e=>{for(const t in e.premier_info)if(t.startsWith("team_")){const i=e.premier_info[t],n=i.teamId,r=i.teamName,o=i.isLocal;this.teams[t]={id:n,name:r,logoUrl:null,isLocal:o,stats:null,players:null},o||u(this,b,Mr).call(this,r);return}},career_stats:e=>{for(const t in e.career_stats)if(t.startsWith("player_")){const i=e.career_stats[t],n=i.playerId,r=Object.values(this.players).filter(Boolean).find(o=>o.id===n);r&&(r.career.previousActs=i.playlists,r.isLoadingPreviousActs=!1);return}}})}handleEvent(e,t){c(this,Jt)[e]&&c(this,Jt)[e](t)}handleInfoUpdate(e,t){c(this,qt)[e]&&c(this,qt)[e](t)}}O=new WeakMap,Jt=new WeakMap,qt=new WeakMap,b=new WeakSet,Ne=function(e,t=!0){const i=Hi.find(n=>n.internalId.toLowerCase()===e.toLowerCase()||n.name.replace("/","")===e.replace("/",""));return i?i.id:(e&&t&&console.error(`[Live Match Service] Unknown agent ID: "${e}".`),null)},kr=function(e){const t=Hi.find(i=>i.id===e);return t?t.name:null},cs=function(e){const t=lo.find(i=>i.internalId===e);return t?t.id:(e&&console.error(`[Live Match Service] Unknown map ID: "${e}".`),null)},Rr=function(e){const t=As.find(i=>i.internalId===e);return t?t.id:(e&&console.error(`[Live Match Service] Unknown playlist ID: "${e}".`),null)},wi=function(e){const t=As.find(i=>i.id===e);return t?t.isTeamBased:!0},yi=function(e){const t=As.find(i=>i.id===e);return t?t.isRoundBased:!0},Nr=function(e){const t=ao.find(i=>i.internalId===e);return t?t.id:(e&&console.error(`[Live Match Service] Unknown weapon ID: "${e}".`),null)},Si=function(e){return!e||e<=2?0:e},ls=function(e,t,i,n,r,o,a,l,h,d,p,f,w){if(e==="scoreboard"&&this.game.screenId!=="TransitionToInGame")return;e==="roster"&&r&&n&&!o&&(o=u(this,b,Ne).call(this,n)),l&&r&&this.me.nickname&&(n=this.me.nickname);const y=(r&&o?u(this,b,kr).call(this,o):n==null?void 0:n.split("#")[0])||`Unknown_${i.substring(0,8)}`,g=Object.values(this.players).filter(Boolean).find(v=>v.id===i);g?(e!=="scoreboard"&&(g.index=t),n&&(g.nickname=n,g.visibleNickname=y),o&&(g.agentId=o),g.isAgentLocked=a,g.isLocal=l,g.isTeammate=h,e!=="roster"&&(g.isNameHidden=r),d&&(g.levelId=d),p!==null&&(g.isLevelHidden=p),f&&(g.rankId=f),w&&(g.rating=w)):this.players[`roster_${t}`]={index:t,id:i,nickname:n,visibleNickname:y,agentId:o,isAgentLocked:a,partyId:null,isLocal:l,isTeammate:h,isNameHidden:r,isLevelHidden:p??!0,levelId:d??0,rankId:f??0,rating:w??0,peakRankId:0,peakRankInSeasonName:null,isAlive:!0,isLoadingProfileOnPreGame:!0,isLoadingProfileOnCoreGame:!0,isProfileFetchedOnPreGame:!1,isProfileFetchedOnCoreGame:!1,isLoadingPreviousActs:!0,isProfileFound:!1,isProfilePrivate:!1,career:{playlistStats:null,agentStats:null,matchHistory:null,previousActs:null},scoreboard:{kills:0,deaths:0,assists:0,headshots:0,firstKills:0,firstDeaths:0,clutches:0},rounds:Array.from({length:50},(v,C)=>({id:C+1,stats:{kills:0,deaths:0,assists:0,headshots:0},isPlayed:C===0,isTraded:!1})),duels:null},u(this,b,Lr).call(this,e,t,o)},Lt=function(e,t){if(t>100){console.error(`[Live Match Service] The local player has a suspicious stat value: ${t} ${e} in a single match.`);return}if(!this.match.isRoundBased&&this.round.phaseId!=="combat")return;const i=this.rounds.find(n=>n.id===this.round.id);i&&(i.stats[e]+=Math.abs(t-this.stats[e])),this.stats[e]=t,!this.match.isRoundBased&&this.round.phaseId==="combat"&&e==="deaths"&&(this.round.id=t+1,u(this,b,hs).call(this))},Pr=function(e,t,i,n,r){const o=Object.values(this.players).filter(Boolean).find(l=>l.id===e);if(!o){console.error(`[Live Match Service] The player was not found. Player ID: ${e}.`);return}o.isAlive=t;const a=o.rounds.find(l=>l.id===this.round.id);a&&(a.stats.kills+=i-o.scoreboard.kills,a.stats.deaths+=n-o.scoreboard.deaths,a.stats.assists+=r-o.scoreboard.assists),c(this,O).isFirstKillInRound&&i>o.scoreboard.kills&&(c(this,O).isFirstKillInRound=!1,o.scoreboard.firstKills++),c(this,O).isFirstDeathInRound&&n>o.scoreboard.deaths&&(c(this,O).isFirstDeathInRound=!1,o.scoreboard.firstDeaths++),o.scoreboard.kills=i,o.scoreboard.deaths=n,o.scoreboard.assists=r,o.scoreboard.kills===0&&(o.scoreboard.headshots=0)},Or=function(e,t){if(!this.match.isRoundBased)return;const i=Object.values(this.players).filter(Boolean),n=i.filter(o=>o.isAlive&&o.isTeammate),r=i.filter(o=>o.isAlive&&!o.isTeammate);if(n.length===1&&r.length>=1||r.length===1&&n.length>=1?(c(this,O).isClutchSituation=!0,n.length===1&&(c(this,O).lastAliveTeammate=n[0]),r.length===1&&(c(this,O).lastAliveOpponent=r[0])):n.length>0&&r.length>0&&(c(this,O).isClutchSituation=!1),e&&(e.lastKill={nickname:(t==null?void 0:t.nickname)||null,timestamp:Date.now()}),t&&t.lastKill&&t.lastKill.timestamp>=Date.now()-1e4){const o=i.find(a=>a.nickname===t.lastKill.nickname);if(o){const a=o.rounds.find(l=>l.id===this.round.id);a&&(a.isTraded=!0)}}},hs=function(){this.rounds.find(t=>t.id===this.round.id)||(this.rounds.push({id:this.round.id,sideId:null,resultId:null,stats:{kills:0,deaths:0,assists:0,headshots:0}}),this.rounds=Object.assign([],this.rounds))},bi=function(){if(!c(this,O).isMatchReset){this.agent.id=null,this.agent.isLocked=!1;for(const e in this.stats)this.stats[e]=0;this.match.id=null,this.match.isActive=!1,this.match.resultId=null,this.score.wins=0,this.score.losses=0,this.round.id=1,this.round.sideId=null,this.round.phaseId=null,this.rounds=[];for(const e in this.players)this.players[e]=null;for(const e in this.teams)this.teams[e]=null;c(this,O).isMatchReset=!0,c(this,O).isFirstKillInRound=!0,c(this,O).isFirstDeathInRound=!0,c(this,O).isClutchSituation=!1,c(this,O).lastAliveTeammate=null,c(this,O).lastAliveOpponent=null,console.warn("[Live Match Service] Reset the previous match data.")}},Dr=function(){Object.values(this.players).filter(Boolean).forEach(e=>{e.isAlive=!0;const t=e.rounds.find(i=>i.id===this.round.id);t&&(t.isPlayed=!0),delete e.lastKill}),c(this,O).isFirstKillInRound=!0,c(this,O).isFirstDeathInRound=!0,c(this,O).isClutchSituation=!1,c(this,O).lastAliveTeammate=null,c(this,O).lastAliveOpponent=null,console.warn("[Live Match Service] Reset the previous round data and update the current round data.")},Lr=async function(e,t,i){const n=this.match.playlistId==="deathmatch";if(e==="roster"&&(!n&&t===9||n&&t===11)&&(await Wi(5e3),this.game.phaseId="InGame",this.game.screenId="TransitionToInGame"),this.match.isCustom&&(e==="player"||e==="roster")){this.game.phaseId==="Pregame"&&t===0&&!i?setTimeout(async()=>{await u(this,b,xe).call(this,"teammates")},1e3):this.game.phaseId==="InGame"&&t===0&&setTimeout(async()=>{await u(this,b,xe).call(this,"all")},1e3);return}if(e==="player"){this.game.phaseId==="Pregame"&&t===4?await u(this,b,xe).call(this,"teammates"):this.game.phaseId==="InGame"&&(!n&&t===9||n&&t===11)&&await u(this,b,xe).call(this,"all");return}if(e==="roster"){this.game.phaseId==="Pregame"&&t===4&&!i?await u(this,b,xe).call(this,"teammates"):this.game.phaseId==="InGame"&&(!n&&t===9||n&&t===11)&&(await Wi(5e3),await u(this,b,xe).call(this,"all"));return}if(e==="scoreboard"){(!n&&t===9||n&&t===11)&&await u(this,b,xe).call(this,"all");return}},Mr=async function(e){const t=await ae.fetchPremierTeamInfo(e,this.me.regionId);if(t){const i=Object.values(this.teams).filter(Boolean).find(n=>n.name.toLowerCase()===e.toLowerCase());i.logoUrl=t.logoUrl,i.stats=t.stats,i.players=t.players}},xe=async function(e){if(["range","npe"].includes(this.match.playlistId))return;const t=Object.values(this.players).filter(Boolean).reduce((i,n)=>((e==="teammates"&&!n.isProfileFetchedOnPreGame||e==="all"&&!n.isProfileFetchedOnCoreGame)&&(n.nickname&&n.nickname.includes("#")?(e==="teammates"?n.isLoadingProfileOnPreGame=!0:e==="all"&&(n.isLoadingProfileOnCoreGame=!0),i.push({playerId:n.id,playerName:n.nickname,agentId:n.agentId,rankId:n.rankId,isLocal:n.isLocal})):(n.isLoadingProfileOnPreGame=!1,n.isLoadingProfileOnCoreGame=!1,n.isProfilePrivate=!0)),i),[]);if(t.length>0){console.log("[Live Match Service] Fetching stats of players in a live match...");const i=await ae.fetchMultipleProfiles(this.game,this.match,t);if(i){this.game.episodeIndex=i.episodeIndex,this.game.actIndex=i.actIndex;for(const n of i.profiles){const r=Object.values(this.players).filter(Boolean).find(o=>o.id===n.id);r&&(r.levelId||(r.levelId=n.levelId),r.rankId||(r.rankId=n.rankId),r.peakRankId=n.peakRankId,r.peakRankInSeasonName=n.peakRankInSeasonName,e==="teammates"?(r.isLoadingProfileOnPreGame=!1,r.isProfileFetchedOnPreGame=!0):e==="all"&&(r.isLoadingProfileOnCoreGame=!1,r.isProfileFetchedOnCoreGame=!0),r.isProfileFound=n.isProfileFound,r.isProfilePrivate=n.isProfilePrivate,r.career.playlistStats||(r.career.playlistStats=n.career.playlistStats),r.career.agentStats||(r.career.agentStats=n.career.agentStats),r.career.matchHistory||(r.career.matchHistory=n.career.matchHistory))}}}};const Br="@firebase/installations",Mi="0.6.10";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $r=1e4,xr=`w:${Mi}`,Ur="FIS_v2",Gl="https://firebaseinstallations.googleapis.com/v1",jl=60*60*1e3,Hl="installations",Wl="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vl={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},ct=new Ss(Hl,Wl,Vl);function Fr(s){return s instanceof Xe&&s.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gr({projectId:s}){return`${Gl}/projects/${s}/installations`}function jr(s){return{token:s.token,requestStatus:2,expiresIn:Jl(s.expiresIn),creationTime:Date.now()}}async function Hr(s,e){const i=(await e.json()).error;return ct.create("request-failed",{requestName:s,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function Wr({apiKey:s}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s})}function zl(s,{refreshToken:e}){const t=Wr(s);return t.append("Authorization",ql(e)),t}async function Vr(s){const e=await s();return e.status>=500&&e.status<600?s():e}function Jl(s){return Number(s.replace("s","000"))}function ql(s){return`${Ur} ${s}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kl({appConfig:s,heartbeatServiceProvider:e},{fid:t}){const i=Gr(s),n=Wr(s),r=e.getImmediate({optional:!0});if(r){const h=await r.getHeartbeatsHeader();h&&n.append("x-firebase-client",h)}const o={fid:t,authVersion:Ur,appId:s.appId,sdkVersion:xr},a={method:"POST",headers:n,body:JSON.stringify(o)},l=await Vr(()=>fetch(i,a));if(l.ok){const h=await l.json();return{fid:h.fid||t,registrationStatus:2,refreshToken:h.refreshToken,authToken:jr(h.authToken)}}else throw await Hr("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zr(s){return new Promise(e=>{setTimeout(e,s)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xl(s){return btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yl=/^[cdef][\w-]{21}$/,vi="";function Ql(){try{const s=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(s),s[0]=112+s[0]%16;const t=Zl(s);return Yl.test(t)?t:vi}catch{return vi}}function Zl(s){return Xl(s).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _s(s){return`${s.appName}!${s.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jr=new Map;function qr(s,e){const t=_s(s);Kr(t,e),eh(t,e)}function Kr(s,e){const t=Jr.get(s);if(t)for(const i of t)i(e)}function eh(s,e){const t=th();t&&t.postMessage({key:s,fid:e}),sh()}let st=null;function th(){return!st&&"BroadcastChannel"in self&&(st=new BroadcastChannel("[Firebase] FID Change"),st.onmessage=s=>{Kr(s.data.key,s.data.fid)}),st}function sh(){Jr.size===0&&st&&(st.close(),st=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ih="firebase-installations-database",nh=1,lt="firebase-installations-store";let xs=null;function Bi(){return xs||(xs=sr(ih,nh,{upgrade:(s,e)=>{switch(e){case 0:s.createObjectStore(lt)}}})),xs}async function fs(s,e){const t=_s(s),n=(await Bi()).transaction(lt,"readwrite"),r=n.objectStore(lt),o=await r.get(t);return await r.put(e,t),await n.done,(!o||o.fid!==e.fid)&&qr(s,e.fid),e}async function Xr(s){const e=_s(s),i=(await Bi()).transaction(lt,"readwrite");await i.objectStore(lt).delete(e),await i.done}async function Is(s,e){const t=_s(s),n=(await Bi()).transaction(lt,"readwrite"),r=n.objectStore(lt),o=await r.get(t),a=e(o);return a===void 0?await r.delete(t):await r.put(a,t),await n.done,a&&(!o||o.fid!==a.fid)&&qr(s,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $i(s){let e;const t=await Is(s.appConfig,i=>{const n=rh(i),r=oh(s,n);return e=r.registrationPromise,r.installationEntry});return t.fid===vi?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function rh(s){const e=s||{fid:Ql(),registrationStatus:0};return Yr(e)}function oh(s,e){if(e.registrationStatus===0){if(!navigator.onLine){const n=Promise.reject(ct.create("app-offline"));return{installationEntry:e,registrationPromise:n}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=ah(s,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:ch(s)}:{installationEntry:e}}async function ah(s,e){try{const t=await Kl(s,e);return fs(s.appConfig,t)}catch(t){throw Fr(t)&&t.customData.serverCode===409?await Xr(s.appConfig):await fs(s.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function ch(s){let e=await wn(s.appConfig);for(;e.registrationStatus===1;)await zr(100),e=await wn(s.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await $i(s);return i||t}return e}function wn(s){return Is(s,e=>{if(!e)throw ct.create("installation-not-found");return Yr(e)})}function Yr(s){return lh(s)?{fid:s.fid,registrationStatus:0}:s}function lh(s){return s.registrationStatus===1&&s.registrationTime+$r<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hh({appConfig:s,heartbeatServiceProvider:e},t){const i=uh(s,t),n=zl(s,t),r=e.getImmediate({optional:!0});if(r){const h=await r.getHeartbeatsHeader();h&&n.append("x-firebase-client",h)}const o={installation:{sdkVersion:xr,appId:s.appId}},a={method:"POST",headers:n,body:JSON.stringify(o)},l=await Vr(()=>fetch(i,a));if(l.ok){const h=await l.json();return jr(h)}else throw await Hr("Generate Auth Token",l)}function uh(s,{fid:e}){return`${Gr(s)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xi(s,e=!1){let t;const i=await Is(s.appConfig,r=>{if(!Qr(r))throw ct.create("not-registered");const o=r.authToken;if(!e&&ph(o))return r;if(o.requestStatus===1)return t=dh(s,e),r;{if(!navigator.onLine)throw ct.create("app-offline");const a=gh(r);return t=fh(s,a),a}});return t?await t:i.authToken}async function dh(s,e){let t=await yn(s.appConfig);for(;t.authToken.requestStatus===1;)await zr(100),t=await yn(s.appConfig);const i=t.authToken;return i.requestStatus===0?xi(s,e):i}function yn(s){return Is(s,e=>{if(!Qr(e))throw ct.create("not-registered");const t=e.authToken;return wh(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function fh(s,e){try{const t=await hh(s,e),i=Object.assign(Object.assign({},e),{authToken:t});return await fs(s.appConfig,i),t}catch(t){if(Fr(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await Xr(s.appConfig);else{const i=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await fs(s.appConfig,i)}throw t}}function Qr(s){return s!==void 0&&s.registrationStatus===2}function ph(s){return s.requestStatus===2&&!mh(s)}function mh(s){const e=Date.now();return e<s.creationTime||s.creationTime+s.expiresIn<e+jl}function gh(s){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},s),{authToken:e})}function wh(s){return s.requestStatus===1&&s.requestTime+$r<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yh(s){const e=s,{installationEntry:t,registrationPromise:i}=await $i(e);return i?i.catch(console.error):xi(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sh(s,e=!1){const t=s;return await bh(t),(await xi(t,e)).token}async function bh(s){const{registrationPromise:e}=await $i(s);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vh(s){if(!s||!s.options)throw Us("App Configuration");if(!s.name)throw Us("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!s.options[t])throw Us(t);return{appName:s.name,projectId:s.options.projectId,apiKey:s.options.apiKey,appId:s.options.appId}}function Us(s){return ct.create("missing-app-config-values",{valueName:s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zr="installations",_h="installations-internal",Ih=s=>{const e=s.getProvider("app").getImmediate(),t=vh(e),i=ki(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},Eh=s=>{const e=s.getProvider("app").getImmediate(),t=ki(e,Zr).getImmediate();return{getId:()=>yh(t),getToken:n=>Sh(t,n)}};function Th(){vt(new at(Zr,Ih,"PUBLIC")),vt(new at(_h,Eh,"PRIVATE"))}Th();ze(Br,Mi);ze(Br,Mi,"esm2017");const Fs="@firebase/remote-config",Sn="0.4.10";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eo="remote-config";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ch={"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"},ne=new Ss("remoteconfig","Remote Config",Ch);function kh(s,e){return s instanceof Xe&&s.code.indexOf(e)!==-1}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rh=!1,Nh="",bn=0,Ph=["1","true","t","yes","y","on"];class Gs{constructor(e,t=Nh){this._source=e,this._value=t}asString(){return this._value}asBoolean(){return this._source==="static"?Rh:Ph.indexOf(this._value.toLowerCase())>=0}asNumber(){if(this._source==="static")return bn;let e=Number(this._value);return isNaN(e)&&(e=bn),e}getSource(){return this._source}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oh(s=ir()){return s=Tt(s),ki(s,eo).getImmediate()}async function Dh(s){const e=Tt(s),[t,i]=await Promise.all([e._storage.getLastSuccessfulFetchResponse(),e._storage.getActiveConfigEtag()]);return!t||!t.config||!t.eTag||t.eTag===i?!1:(await Promise.all([e._storageCache.setActiveConfig(t.config),e._storage.setActiveConfigEtag(t.eTag)]),!0)}function Lh(s){const e=Tt(s);return e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0})),e._initializePromise}async function Mh(s){const e=Tt(s),t=new Ah;setTimeout(async()=>{t.abort()},e.settings.fetchTimeoutMillis);try{await e._client.fetch({cacheMaxAgeMillis:e.settings.minimumFetchIntervalMillis,signal:t}),await e._storageCache.setLastFetchStatus("success")}catch(i){const n=kh(i,"fetch-throttle")?"throttle":"failure";throw await e._storageCache.setLastFetchStatus(n),i}}function js(s,e){const t=Tt(s);t._isInitializationComplete||t._logger.debug(`A value was requested for key "${e}" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.`);const i=t._storageCache.getActiveConfig();return i&&i[e]!==void 0?new Gs("remote",i[e]):t.defaultConfig&&t.defaultConfig[e]!==void 0?new Gs("default",String(t.defaultConfig[e])):(t._logger.debug(`Returning static value for key "${e}". Define a default or remote value if this is unintentional.`),new Gs("static"))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{constructor(e,t,i,n){this.client=e,this.storage=t,this.storageCache=i,this.logger=n}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const i=Date.now()-t,n=i<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${i}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${n}.`),n}async fetch(e){const[t,i]=await Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(i&&this.isCachedDataFresh(e.cacheMaxAgeMillis,t))return i;e.eTag=i&&i.eTag;const n=await this.client.fetch(e),r=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return n.status===200&&r.push(this.storage.setLastSuccessfulFetchResponse(n)),await Promise.all(r),n}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $h(s=navigator){return s.languages&&s.languages[0]||s.language}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh{constructor(e,t,i,n,r,o){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=i,this.projectId=n,this.apiKey=r,this.appId=o}async fetch(e){const[t,i]=await Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),r=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,o={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},a={sdk_version:this.sdkVersion,app_instance_id:t,app_instance_id_token:i,app_id:this.appId,language_code:$h()},l={method:"POST",headers:o,body:JSON.stringify(a)},h=fetch(r,l),d=new Promise((v,C)=>{e.signal.addEventListener(()=>{const Y=new Error("The operation was aborted.");Y.name="AbortError",C(Y)})});let p;try{await Promise.race([h,d]),p=await h}catch(v){let C="fetch-client-network";throw(v==null?void 0:v.name)==="AbortError"&&(C="fetch-timeout"),ne.create(C,{originalErrorMessage:v==null?void 0:v.message})}let f=p.status;const w=p.headers.get("ETag")||void 0;let y,g;if(p.status===200){let v;try{v=await p.json()}catch(C){throw ne.create("fetch-client-parse",{originalErrorMessage:C==null?void 0:C.message})}y=v.entries,g=v.state}if(g==="INSTANCE_STATE_UNSPECIFIED"?f=500:g==="NO_CHANGE"?f=304:(g==="NO_TEMPLATE"||g==="EMPTY_CONFIG")&&(y={}),f!==304&&f!==200)throw ne.create("fetch-status",{httpStatus:f});return{status:f,eTag:w,config:y}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uh(s,e){return new Promise((t,i)=>{const n=Math.max(e-Date.now(),0),r=setTimeout(t,n);s.addEventListener(()=>{clearTimeout(r),i(ne.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Fh(s){if(!(s instanceof Xe)||!s.customData)return!1;const e=Number(s.customData.httpStatus);return e===429||e===500||e===503||e===504}class Gh{constructor(e,t){this.client=e,this.storage=t}async fetch(e){const t=await this.storage.getThrottleMetadata()||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,t)}async attemptFetch(e,{throttleEndTimeMillis:t,backoffCount:i}){await Uh(e.signal,t);try{const n=await this.client.fetch(e);return await this.storage.deleteThrottleMetadata(),n}catch(n){if(!Fh(n))throw n;const r={throttleEndTimeMillis:Date.now()+Na(i),backoffCount:i+1};return await this.storage.setThrottleMetadata(r),this.attemptFetch(e,r)}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jh=60*1e3,Hh=12*60*60*1e3;class Wh{constructor(e,t,i,n,r){this.app=e,this._client=t,this._storageCache=i,this._storage=n,this._logger=r,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:jh,minimumFetchIntervalMillis:Hh},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function us(s,e){const t=s.target.error||void 0;return ne.create(e,{originalErrorMessage:t&&(t==null?void 0:t.message)})}const tt="app_namespace_store",Vh="firebase_remote_config",zh=1;function Jh(){return new Promise((s,e)=>{try{const t=indexedDB.open(Vh,zh);t.onerror=i=>{e(us(i,"storage-open"))},t.onsuccess=i=>{s(i.target.result)},t.onupgradeneeded=i=>{const n=i.target.result;switch(i.oldVersion){case 0:n.createObjectStore(tt,{keyPath:"compositeKey"})}}}catch(t){e(ne.create("storage-open",{originalErrorMessage:t==null?void 0:t.message}))}})}class qh{constructor(e,t,i,n=Jh()){this.appId=e,this.appName=t,this.namespace=i,this.openDbPromise=n}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}async get(e){const t=await this.openDbPromise;return new Promise((i,n)=>{const o=t.transaction([tt],"readonly").objectStore(tt),a=this.createCompositeKey(e);try{const l=o.get(a);l.onerror=h=>{n(us(h,"storage-get"))},l.onsuccess=h=>{const d=h.target.result;i(d?d.value:void 0)}}catch(l){n(ne.create("storage-get",{originalErrorMessage:l==null?void 0:l.message}))}})}async set(e,t){const i=await this.openDbPromise;return new Promise((n,r)=>{const a=i.transaction([tt],"readwrite").objectStore(tt),l=this.createCompositeKey(e);try{const h=a.put({compositeKey:l,value:t});h.onerror=d=>{r(us(d,"storage-set"))},h.onsuccess=()=>{n()}}catch(h){r(ne.create("storage-set",{originalErrorMessage:h==null?void 0:h.message}))}})}async delete(e){const t=await this.openDbPromise;return new Promise((i,n)=>{const o=t.transaction([tt],"readwrite").objectStore(tt),a=this.createCompositeKey(e);try{const l=o.delete(a);l.onerror=h=>{n(us(h,"storage-delete"))},l.onsuccess=()=>{i()}}catch(l){n(ne.create("storage-delete",{originalErrorMessage:l==null?void 0:l.message}))}})}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}async loadFromStorage(){const e=this.storage.getLastFetchStatus(),t=this.storage.getLastSuccessfulFetchTimestampMillis(),i=this.storage.getActiveConfig(),n=await e;n&&(this.lastFetchStatus=n);const r=await t;r&&(this.lastSuccessfulFetchTimestampMillis=r);const o=await i;o&&(this.activeConfig=o)}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xh(){vt(new at(eo,s,"PUBLIC").setMultipleInstances(!0)),ze(Fs,Sn),ze(Fs,Sn,"esm2017");function s(e,{instanceIdentifier:t}){const i=e.getProvider("app").getImmediate(),n=e.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw ne.create("registration-window");if(!Qn())throw ne.create("indexed-db-unavailable");const{projectId:r,apiKey:o,appId:a}=i.options;if(!r)throw ne.create("registration-project-id");if(!o)throw ne.create("registration-api-key");if(!a)throw ne.create("registration-app-id");t=t||"firebase";const l=new qh(a,i.name,t),h=new Kh(l),d=new Zn(Fs);d.logLevel=B.ERROR;const p=new xh(n,kc,t,r,o,a),f=new Gh(p,l),w=new Bh(f,l,h,d),y=new Wh(i,w,h,l,d);return Lh(y),y}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yh(s){return s=Tt(s),await Mh(s),Dh(s)}Xh();const Qh={apiKey:"AIzaSyDokEkJiCsgzSXapZPGqQLRMnYtqnjLihw",authDomain:"valorant-tracker-6b622.firebaseapp.com",projectId:"valorant-tracker-6b622",storageBucket:"valorant-tracker-6b622.appspot.com",messagingSenderId:"89594807163",appId:"1:89594807163:web:a303278c78dfdfe00fb3de"},Zh={API_HOST:"api.tracker.network",WS_ENABLED:!1,CUSTOM_GEP_ENABLED:!0,DEFAULT_GEP_ENABLED:!0};class eu{constructor(){this.app=Ri(Qh,"valorant"),this.remoteConfig=Oh(this.app),this.remoteConfig.settings.minimumFetchIntervalMillis=3*60*1e3,this.remoteConfig.settings.fetchTimeoutMillis=30*1e3,this.remoteConfig.defaultConfig=Zh,this.isRefreshed=!1}async refreshConfig(){try{this.isRefreshed=await Yh(this.remoteConfig)}catch(e){console.error(e),M.notify(e)}}getValueAsBoolean(e){try{const t=js(this.remoteConfig,e).asBoolean();return console.log(`[Remote Config] The parameter "${e}" is set to "${t}".`),t}catch(t){return console.error(t),M.notify(t),null}}getValueAsNumber(e){try{const t=js(this.remoteConfig,e).asNumber();return t?(console.log(`[Remote Config] The parameter "${e}" is set to "${t}".`),t):null}catch(t){return console.error(t),M.notify(t),null}}getValueAsString(e,t=!1){try{const i=js(this.remoteConfig,e).asString();return i?(console.log(`[Remote Config] The parameter "${e}" is set to "${i}".`),t&&(localStorage[e]=i),i):null}catch(i){return console.error(i),M.notify(i),null}}}class ee{static getSeasonalStats(e,t){try{let i=localStorage[e]?JSON.parse(localStorage[e]):null;if(!t)return i;if(i)for(const n in t){i[n]||(i[n]={});for(const r in t[n])i[n][r]=t[n][r]}else i=t;return localStorage[e]=JSON.stringify(i),i}catch(i){return console.error(i),M.notify(i),null}}static getPreviousActs(e,t="previousActs"){try{let i=localStorage[t]?JSON.parse(localStorage[t]):null;if(!e)return i;if(i)for(const n in e)i[n]=e[n];else i=e;return localStorage[t]=JSON.stringify(i),i}catch(i){return console.error(i),M.notify(i),null}}static getRecentMatches(e,t,i="matches"){try{const n=localStorage[i]?JSON.parse(localStorage[i]):{};if(!e||!t)return n;n[t]||(n[t]=[]);for(const r of e){const o=r.id,a=n[t].findIndex(l=>l.id===o);a>-1&&n[t].splice(a,1),n[t].unshift(r)}return n[t].sort((r,o)=>o.end-r.end),n[t].splice(100),localStorage[i]=JSON.stringify(n),n}catch(n){return console.error(n),M.notify(n),null}}}class pt{}A(pt,"Launched","gameLaunched"),A(pt,"Terminated","gameTerminated"),A(pt,"FocusChanged","gameFocusChanged"),A(pt,"ResolutionChanged","gameResolutionChanged");class _i{}A(_i,"Down","down"),A(_i,"Up","up");class ce{}A(ce,"Game","gamelaunchevent"),A(ce,"Overwolf","overwolfstartlaunchevent"),A(ce,"Installation","after-install"),A(ce,"Restart","relaunch"),A(ce,"Hotkey","hotkey"),A(ce,"Store","storeapi"),A(ce,"Dock","dock"),A(ce,"Tray","tray"),A(ce,"Shortcut","commandline"),A(ce,"Url","urlscheme");class mt{}A(mt,"Green","green"),A(mt,"Yellow","yellow"),A(mt,"Red","red");class we{}A(we,"UpToDate","UpToDate"),A(we,"UpdateAvailable","UpdateAvailable"),A(we,"PendingRestart","PendingRestart"),A(we,"UpdateInstalled","UpdateInstalled");class R{}A(R,"Closed","closed"),A(R,"Hidden","hidden"),A(R,"Minimized","minimized"),A(R,"Normal","normal"),A(R,"Maximized","maximized");const to=["me","kill","death","game_info","match_info"],tu=["victory","kill","death"],Hs={TOGGLE:"toggle",SWITCH_VIEW:"switch-view",TAB:"tab"},su={authUri:"https://account.tracker.gg",oauth:{client_id:"cbdf32c6-a155-47e4-8995-e2295e71f873",scope:"openid profile account api events offline_access",redirect_uri:"overwolf-extension-ipmlnnogholfmdmenfijjifldcpjoecappfccceh://auth/authorize",post_logout_redirect_uri:"overwolf-extension-ipmlnnogholfmdmenfijjifldcpjoecappfccceh://auth/logout",response_type:"code"}},vn={PLAN:27},m={BACKGROUND:"background",DESKTOP:"desktop",INGAME:"ingame",SECOND_SCREEN:"second_screen",DUELS:"duels",TEAMMATES:"teammates",TIMELINE:"timeline",GUIDES:"guides",ASSISTANT:"assistant"},iu=new Ul,ht=new ua(su),Ws=new Gc,nu=new fe,ru=new Qe,Vs=new ds(to),zs=new ds(["*"],iu),ou=new An,au=new ut,cu=new dt,lu=new S,Rt=new eu,_n=new Bl(co.REALTIME),In=new jc("support-plugin"),hu={name:"Background",data:function(){for(let e in localStorage)localStorage[e]==="undefined"&&delete localStorage[e];if(!localStorage.v3storage){for(let e in localStorage)["platform","subscription","user","welcome","previousAppVersion","nickname","playlistId","seasonId","isAssistantTooltipShown","events"].includes(e)||delete localStorage[e];localStorage.v3storage="1"}localStorage.v4storage||(delete localStorage.insights,delete localStorage.agents,delete localStorage.maps,localStorage.v4storage="1"),localStorage.defaultSeasonId&&(localStorage.seasonId=localStorage.defaultSeasonId),localStorage.playlistId||(localStorage.playlistId="competitive");let s=[];if(localStorage.profiles)try{s=JSON.parse(localStorage.profiles)}catch(e){console.error(e),delete localStorage.profiles}return{system:{language:null,monitors:null},extension:{id:null,name:null,title:null,author:null,version:null,windows:null,hotkeys:null,launchSource:null,update:we.UpToDate},service:{events:mt.Green,endpoints:mt.Green,message:null},user:{clientId:null,machineId:null,trn:null,overwolf:null},referrals:{personalReferralUrl:localStorage.personalReferralUrl||null,completedReferrals:localStorage.previousCompletedReferrals?Number(localStorage.previousCompletedReferrals):0,isNewReferralDetected:!1},subscription:{isTrackerNetworkSubscriptionActive:!1,isGameProfileSubscriptionActive:!1,isOverwolfSubscriptionActive:!1},profiles:s,game:{id:null,isRunning:!1,isInFocus:!1,width:null,height:null,logicalWidth:null,logicalHeight:null,session:new Fl,profile:{init:!1,private:!1,defaultSeasonId:localStorage.defaultSeasonId,user:localStorage.user?JSON.parse(localStorage.user):null,progress:localStorage.progress?JSON.parse(localStorage.progress):null,playlists:ee.getSeasonalStats("playlists"),agents:ee.getSeasonalStats("agents"),maps:ee.getSeasonalStats("maps"),weapons:ee.getSeasonalStats("weapons"),previousActs:ee.getPreviousActs(),matches:ee.getRecentMatches(),options:{mode:localStorage.playlistId||"competitive"},updater:{isUpdating:!1,isFetchingConfig:!1,isConnecting:!1,isConnected:!1,lastUpdate:null,timeoutId:null,nextUpdate:null}},guides:{},insights:localStorage.insights?JSON.parse(localStorage.insights):null,seasons:localStorage.seasons?JSON.parse(localStorage.seasons):null},media:{size:0,availableEvents:tu,enabledEvents:localStorage.events?JSON.parse(localStorage.events):[],recordings:[]},settings:{isOverlayEnabled:!0,isAutoLaunchEnabled:!0,environmentId:null,releaseChannelId:null,isSecondScreenEnabled:!0,preferredMonitorId:null,isDuelsEnabled:!0,isTeammatesWidgetEnabled:!0,isGuideShowingEnabled:!1,liveMatchPlaylistStatsKeys:["kd","matchWinPct","scorePerRound","headshotPct","matchesPlayed"],liveMatchAgentStatsKeys:["kd","matchWinPct","scorePerRound"],agentSelectPlaylistStatsKeys:["kd","matchWinPct","headshotPct","damagePerRound","damageDeltaPerRound"]},gui:{welcome:!localStorage.welcome,service:!1,liveMatchView:"match-stats"},xpHub:{lastUpdateDate:null}}},created:async function(){window.background=this.$data,window.auth=o=>{switch(o){case"sign-in":ht.signInRedirect();return;case"sign-out":ht.signOutSilent(),window.clearAuth();return;case"register":ht.signInRedirect(null,{acr_values:"show:register"});return}},window.changeGameProfile=(o,a=null,l=!1,h=!0)=>{if(l||console.warn(`[Settings] Changing the game profile: "${o}".`),o==="link"){if(!a)return;const d=this.profiles.find(f=>f.isCurrent&&f.platformInfo.platformUserId===a.platformUserId);if(d){console.warn("[Settings] The game profile is linked already, cancelling."),d.platformInfo.platformUserHandle=a.platformUserHandle,d.platformInfo.platformUserIdentifier=a.platformUserIdentifier,localStorage.profiles=JSON.stringify(this.profiles);return}window.changeGameProfile("unlink",null,!0),this.profiles.forEach(f=>{f.isCurrent=!1});const p=this.profiles.find(f=>f.platformInfo.platformUserId===a.platformUserId);if(p)p.isCurrent=!0,p.platformInfo.platformUserHandle=a.platformUserHandle,p.platformInfo.platformUserIdentifier=a.platformUserIdentifier;else{const f=JSON.parse(JSON.stringify(this.profiles));f.push({platformInfo:a,isCurrent:!0}),this.profiles=f}localStorage.nickname=a.platformUserIdentifier,localStorage.profiles=JSON.stringify(this.profiles),h&&window.startWebSocketConnection();return}if(o==="unlink"){const d=this.profiles.find(f=>f.isCurrent);d&&(d.isCurrent=!1);const p=["id","nickname","regionId","user","progress","playlists","agents","maps","weapons","previousActs","matches","isGameProfileSubscriptionActive"];for(const f of p)localStorage.removeItem(f);this.game.profile.init=!1,this.game.profile.private=!1,this.game.profile.user=null,this.game.profile.playlists=null,this.game.profile.agents=null,this.game.profile.maps=null,this.game.profile.weapons=null,this.game.profile.previousActs=null,this.game.profile.matches=null,localStorage.isGameProfileSubscriptionActive=this.subscription.isGameProfileSubscriptionActive=!1,window.stopWebSocketConnection(),localStorage.profiles=JSON.stringify(this.profiles);return}if(o==="remove"){if(!a)return;this.profiles=this.profiles.filter(d=>d.platformInfo.platformUserIdentifier!==a.platformUserIdentifier),localStorage.profiles=JSON.stringify(this.profiles);return}},window.changeAppSetting=async(o,a)=>{console.warn(`[Settings] Changing the app setting: "${o}: ${a}".`),!(o==="releaseChannelId"&&!await fe.setReleaseChannelId(a))&&(this.settings[o]=a,Array.isArray(a)?localStorage[o]=JSON.stringify(a):localStorage[o]=String(a))},window.clearAuth=()=>{this.user.trn=null,delete localStorage.isReferredBySomeoneChecked,delete localStorage.personalReferralUrl,delete localStorage.previousCompletedReferrals,this.referrals.personalReferralUrl=null,this.referrals.completedReferrals=0,this.referrals.isNewReferralDetected=!1},window.resetAppData=async o=>{if(console.warn(`[Settings] Deleting the app data: "${o}".`),["all","profile"].includes(o)&&window.changeGameProfile("unlink"),["all","media"].includes(o)){const a=["events"];for(const l of a)localStorage.removeItem(l);this.media.enabledEvents=[],this.media.recordings=[],indexedDB.deleteDatabase("media"),await ut.deleteAllHighlights()}["all"].includes(o)&&(localStorage.clear(),window.clearAuth(),this.subscription.isTrackerNetworkSubscriptionActive=!1,this.subscription.isGameProfileSubscriptionActive=!1,this.subscription.isOverwolfSubscriptionActive=!1)},window.closeWelcomeScreen=()=>{localStorage.welcome=this.gui.welcome=!1},window.closeServiceNotification=()=>{this.gui.service=!1},window.closeUpdateNotification=()=>{this.extension.update=we.UpToDate},window.refreshHighlights=async()=>{this.media.size=await ut.getMediaFolderSize(),this.media.recordings=await Ts.getHighlights()},window.refreshMediaFolderSize=async()=>{this.media.size=await ut.getMediaFolderSize()},window.toggleCaptureEvents=o=>{this.media.enabledEvents.includes(o)?this.media.enabledEvents.splice(this.media.enabledEvents.indexOf(o),1):this.media.enabledEvents.push(o),this.media.enabledEvents=[...this.media.enabledEvents],localStorage.events=JSON.stringify(this.media.enabledEvents)},localStorage.isGameProfileSubscriptionActive==="true"&&(this.subscription.isGameProfileSubscriptionActive=!0),window.assignProfile=async(o,a)=>{localStorage.nickname=a,window.startWebSocketConnection()},window.switchGameAccount=()=>{window.changeGameProfile("unlink")},window.refreshGameEventsStatus=async()=>{if(this.game.id){let o=await ds.getGameEventsStatus(this.game.id,to);o&&(this.service.events!==o&&(this.gui.service=o===mt.Red),this.service.events=o)}setTimeout(()=>{window.refreshGameEventsStatus()},10*60*1e3)},window.refreshGlobalStats=async(o=null,a=null,l=!1)=>{if(sessionStorage.isChina==="1")return;this.game.profile.updater.isUpdating=!0;const h=localStorage.nickname,d=o||localStorage.playlistId,p=a||localStorage.seasonId,f=!this.game.profile.user||!h,w=this.game.profile.user&&h&&this.game.profile.user.nickname!==h,y=h&&d&&p&&!["range","npe"].includes(d);if(w&&window.changeGameProfile("unlink"),y){console.log(`[Background] Updating the game profile for "${h}" (playlist ID: "${d}", season ID: "${p}").`);const g=!this.game.profile.init;let v;if(g){if(v=await ae.fetchProfile(h),v&&v.isChina){sessionStorage.isChina="1",this.game.profile.updater.isUpdating=!1;return}v&&!v.isPrivate&&(localStorage.defaultSeasonId=this.game.profile.defaultSeasonId=v.seasonId,v.user.nickname!==h&&(localStorage.nickname=v.user.nickname),(f||w||!localStorage.profiles)&&window.changeGameProfile("link",v.platformInfo,!1,!1))}else v=await ae.fetchPlaylist(d,p,h,l);if(v&&(this.game.profile.private=v.isPrivate,!v.isPrivate)){this.game.profile.init=!0,v.isPremium!==null&&(localStorage.isGameProfileSubscriptionActive=this.subscription.isGameProfileSubscriptionActive=v.isPremium),v.user&&(this.game.profile.user=v.user,localStorage.user=JSON.stringify(v.user)),v.progress&&localStorage.defaultSeasonId===localStorage.seasonId&&(this.game.profile.progress=v.progress,localStorage.progress=JSON.stringify(v.progress)),v.playlists&&(this.game.profile.playlists=ee.getSeasonalStats("playlists",v.playlists)),v.agents&&(this.game.profile.agents=ee.getSeasonalStats("agents",v.agents)),v.maps&&(this.game.profile.maps=ee.getSeasonalStats("maps",v.maps)),v.weapons&&(this.game.profile.weapons=ee.getSeasonalStats("weapons",v.weapons));const C=await ae.fetchRecentMatches(d,h,l);if(C&&(this.game.profile.matches=ee.getRecentMatches(C,d)),g){const Y=await ae.fetchSeasonReport("competitive",h);Y&&(this.game.profile.previousActs=ee.getPreviousActs(Y))}}this.xpHub.lastUpdateDate=Date.now()}this.game.profile.updater.isUpdating=!1},window.refreshGlobalStatsOnTimer=async()=>{let o=(this.game.session.match.isActive?30:3)*60*1e3;window.stopRefreshingGlobalStatsOnTimer(),await window.refreshGlobalStats(),this.game.profile.updater.nextUpdate=Math.floor((Date.now()+o)/1e3),this.game.profile.updater.timeoutId=setTimeout(()=>{window.refreshGlobalStatsOnTimer()},o)},window.stopRefreshingGlobalStatsOnTimer=()=>{typeof this.game.profile.updater.timeoutId=="number"&&clearTimeout(this.game.profile.updater.timeoutId)},window.refreshLast30DaysStats=async o=>{let a=localStorage.nickname;if(!a||!o||["deathmatch","escalation","range"].includes(o))return;let l=await ae.fetchPlaylist(o,"last-30-days",a);l&&!l.isPrivate&&(l.playlists&&(this.game.profile.playlists=ee.getSeasonalStats("playlists",l.playlists)),l.agents&&(this.game.profile.agents=ee.getSeasonalStats("agents",l.agents)),l.maps&&(this.game.profile.maps=ee.getSeasonalStats("maps",l.maps)))},window.startWebSocketConnection=async()=>{if(this.game.profile.updater.isFetchingConfig=!0,await Rt.refreshConfig(),this.game.profile.updater.isFetchingConfig=!1,!Rt.getValueAsBoolean("WS_ENABLED")&&!localStorage.bypassRemoteConfig){window.refreshGlobalStatsOnTimer();return}else window.refreshGlobalStats();if(!localStorage.nickname)return;let a="valorant.profile.updates",l={platformUserIdentifier:localStorage.nickname},h={onStatusUpdate:p=>{console.log(`[SocketIO] New WebSocket status: ${p}.`),p==="connecting"||p==="reconnecting"?(this.game.profile.updater.isConnecting=!0,this.game.profile.updater.isConnected=!1):p==="connected"?(this.game.profile.updater.isConnecting=!1,this.game.profile.updater.isConnected=!0):(p==="disconnected"||p==="failed")&&(this.game.profile.updater.isConnecting=!1,this.game.profile.updater.isConnected=!1),p==="reconnecting"||p==="connected"?window.stopRefreshingGlobalStatsOnTimer():p==="failed"&&window.refreshGlobalStatsOnTimer()},onNewEvent:({payload:p})=>{if(!p){console.error("[SocketIO] Empty payload");return}setTimeout(async()=>{await window.refreshGlobalStats(this.game.session.match.playlistId||localStorage.playlistId,null,!0)},5e3)}},d={title:"valorant",source:"overwolf"};_n.subscribe(a,l,h,d)},window.stopWebSocketConnection=()=>{_n.unsubscribe()},window.refreshInsights=async()=>{let o=[],a=await ae.fetchInsights("agents");a&&o.push(...a);let l=await ae.fetchInsights("agent-maps");l&&o.push(...l);let h=ae._getInsights(o);this.game.insights=h,localStorage.insights=JSON.stringify(h)},window.refreshSeasons=async()=>{let o=await ae.fetchSeasons();o&&o.isChina||(o?(this.game.seasons=o,localStorage.seasons=JSON.stringify(o),localStorage.seasonId||(localStorage.seasonId=o[0].id)):setTimeout(async()=>{await window.refreshSeasons()},12e4))},window.switchToSecondScreen=async(o=!0)=>{const a=this.system.monitors.find(f=>f.id===this.settings.preferredMonitorId)||this.system.monitors.find(f=>!f.isPrimary),l=this.subscription.isTrackerNetworkSubscriptionActive||this.subscription.isGameProfileSubscriptionActive||this.subscription.isOverwolfSubscriptionActive,h=a.width/window.devicePixelRatio,d=a.height/window.devicePixelRatio,p=1280+(!l&&this.settings.isDuelsEnabled&&h>1712?432:0);{const f=m.SECOND_SCREEN,w={width:1280,height:680};let y=a.leftOffset+(h-w.width)/2,g=a.topOffset+(d-w.height)/2;!l&&this.settings.isDuelsEnabled&&h>1712&&(y=a.leftOffset+(h-p)/2+400+32),await S.restore(f),await S.changeSize(f,w.width,w.height),await S.changePosition(f,y,g),await S.bringToFront(f)}if(!l&&this.settings.isDuelsEnabled&&h>1712){const f=m.DUELS,w={width:400,height:680},y=a.leftOffset+(h-p)/2,g=a.topOffset+(d-w.height)/2;await S.restore(f),await S.changeSize(f,w.width,w.height),await S.changePosition(f,y,g),await S.bringToFront(f)}else this.extension.windows[m.DUELS].state!==R.Closed&&await S.close(m.DUELS);o&&this.extension.windows[m.DESKTOP].state!==R.Closed&&await S.hide(m.DESKTOP)},window.disableSecondScreen=async()=>{await S.hide(m.SECOND_SCREEN),this.extension.windows[m.DUELS].state!==R.Closed&&await S.hide(m.DUELS)},window.refreshHighlights(),this.system.language=await ho.getCurrentLanguage(),this.system.monitors=await Cs.getMonitors(),overwolf.windows.onScreenPropertyChanged.addListener(o=>{const a=o.monitor,l=String(o.monitor.handle.value),h=this.system.monitors.find(d=>d.id===l);h&&(h.width=a.width,h.height=a.height,h.leftOffset=a.x,h.topOffset=a.y)});let s=await fe.getManifest();this.extension.id=s.UID,this.extension.name=s.meta.name,this.extension.title="valorant",this.extension.author=s.meta.author,this.extension.version=s.meta.version,this.extension.launchSource=fe.getLaunchSource(),this.extension.windows=await S.getWindowsStates(),this.extension.hotkeys=await An.getHotkeys(),lu.addEventListeners({onWindowStateChanged:this.onWindowStateChanged}),ou.addEventListeners({onHotkeyChanged:this.onHotkeyChanged,onHotkeyPressed:this.onHotkeyPressed,onHotkeyHold:this.onHotkeyHold}),nu.register({onAppLaunchTriggered:this.onAppLaunchTriggered,onAutoLaunchChanged:this.onAutoLaunchChanged});const e=await dt.getCurrentUserInfo();e&&(this.user.clientId=e.clientId,this.user.machineId=e.machineId);const t=await dt.getOverwolfUserInfo();t&&(this.user.overwolf=t);const i=await dt.getCurrentSubscriptions();this.subscription.isOverwolfSubscriptionActive=dt.isSubscribed(i,vn.PLAN),cu.addEventListeners({onSubscriptionChanged:this.onSubscriptionChanged}),ht.addEventListeners({onLoginStateChanged:this.onTrnLoginStateChanged}),ht.signInSilent(),this.game.id=s.data.game_events[0];const n=await Qe.getRunningGameInfo();n&&(this.game.isRunning=Qe.isGameRunning(n,this.game.id),this.game.isInFocus=Qe.isGameInFocus(n,this.game.id),this.game.isRunning&&this.game.isInFocus&&(this.game.width=n.width,this.game.height=n.height,this.game.logicalWidth=n.logicalWidth,this.game.logicalHeight=n.logicalHeight),this.game.isRunning&&(Vs.addEventListeners({onNewEvent:this.onNewEvent,onInfoUpdate:this.onInfoUpdate}),(!localStorage.CUSTOM_GEP_ENABLED||localStorage.CUSTOM_GEP_ENABLED==="true")&&zs.addEventListeners({onNewEvent:this.onNewEvent,onInfoUpdate:this.onInfoUpdate}))),ru.addEventListeners({onGameInfoChanged:this.onGameInfoChanged,onOverlayChanged:this.onOverlayChanged}),au.register({onHighlightsCaptured:this.onHighlightsCaptured}),this.settings.isOverlayEnabled=await Qe.isOverlayEnabled(this.game.id),this.settings.isAutoLaunchEnabled=await fe.isAutoLaunchEnabled(this.game.id),this.settings.environmentId=await fe.getEnvironmentId(),this.settings.releaseChannelId=await fe.getReleaseChannelId(),localStorage.isSecondScreenEnabled&&(this.settings.isSecondScreenEnabled=localStorage.isSecondScreenEnabled==="true"),localStorage.preferredMonitorId&&(this.settings.preferredMonitorId=localStorage.preferredMonitorId),localStorage.isDuelsEnabled&&(this.settings.isDuelsEnabled=localStorage.isDuelsEnabled==="true"),localStorage.isTeammatesWidgetEnabled&&(this.settings.isTeammatesWidgetEnabled=localStorage.isTeammatesWidgetEnabled==="true"),localStorage.isGuideShowingEnabled&&(this.settings.isGuideShowingEnabled=localStorage.isGuideShowingEnabled==="true");try{localStorage.liveMatchPlaylistStatsKeys&&(this.settings.liveMatchPlaylistStatsKeys=JSON.parse(localStorage.liveMatchPlaylistStatsKeys))}catch(o){console.error(o),delete localStorage.liveMatchPlaylistStatsKeys}try{localStorage.liveMatchAgentStatsKeys&&(this.settings.liveMatchAgentStatsKeys=JSON.parse(localStorage.liveMatchAgentStatsKeys))}catch(o){console.error(o),delete localStorage.liveMatchAgentStatsKeys}try{localStorage.agentSelectPlaylistStatsKeys&&(this.settings.agentSelectPlaylistStatsKeys=JSON.parse(localStorage.agentSelectPlaylistStatsKeys))}catch(o){console.error(o),delete localStorage.agentSelectPlaylistStatsKeys}this.extension.launchSource!==ce.Game&&(this.game.isRunning&&this.game.isInFocus?await S.restore(m.INGAME):await S.restore(m.DESKTOP)),window.refreshGameEventsStatus(),window.refreshInsights(),window.refreshSeasons(),window.startWebSocketConnection();try{await In.init(),window.getLogsZip=async()=>{let o=JSON.stringify({data:this.$data,systemInfo:await Cs.getSystemInfo(),regionalInfo:await Cs.getRegionalInfo()},null,"	");await In.collectLogs(o)}}catch(o){console.error(o)}fe.isUpdateInstalled(localStorage.previousAppVersion,this.extension.version)&&(this.extension.update=we.UpdateInstalled),localStorage.previousAppVersion=this.extension.version,setTimeout(async()=>{const o=await fe.checkForUpdates();if((o==null?void 0:o.status)===we.UpdateAvailable){this.extension.update=we.UpdateAvailable;const a=await fe.update();(a==null?void 0:a.status)===we.PendingRestart&&(this.extension.update=we.PendingRestart)}},1e4),setTimeout(async()=>{this.media.recordings&&(await Ts.runHighlightsStorageCleanup(this.media.recordings),await window.refreshHighlights())},15e3),await Rt.refreshConfig(),Rt.getValueAsString("DEFAULT_GEP_ENABLED",!0),Rt.getValueAsString("CUSTOM_GEP_ENABLED",!0)},methods:{async onTrnLoginStateChanged(s,e){if(!e){window.clearAuth();return}this.user.trn=e,this.subscription.isTrackerNetworkSubscriptionActive=e.profile.role.includes("Premium")},onSubscriptionChanged(s){this.subscription.isOverwolfSubscriptionActive=dt.isSubscribed(s,vn.PLAN)},onOverlayChanged(s,e){this.game.id===s&&(this.settings.isOverlayEnabled=e)},onAutoLaunchChanged(s,e,t){this.extension.id===s&&this.game.id===e&&(this.settings.isAutoLaunchEnabled=t)},onHotkeyChanged(s,e,t){const i=this.extension.hotkeys.find(n=>n.id===s&&n.gameId===e);i&&(i.binding=t)},async onHighlightsCaptured(s){this.game.id===s.gameId&&await Ts.addHighlight(s,{modeId:this.game.session.match.modeId,playlistId:this.game.session.match.playlistId})},async onGameInfoChanged(s,e){if(this.game.isRunning=Qe.isGameRunning(e,this.game.id),this.game.isInFocus=Qe.isGameInFocus(e,this.game.id),this.game.isRunning&&this.game.isInFocus&&(this.game.width=e.width,this.game.height=e.height,this.game.logicalWidth=e.logicalWidth,this.game.logicalHeight=e.logicalHeight,this.extension.windows[m.TEAMMATES].state===R.Normal)){let t={width:this.game.logicalWidth,height:this.game.logicalHeight},i={width:640,height:320};const n=this.game.logicalWidth/this.game.width;i.width=n*i.width;let r=t.width/2-i.width/2,o=t.height/2-i.height/1.75;await S.changeSize(m.TEAMMATES,i.width,i.height),await S.changePosition(m.TEAMMATES,r,o)}(s===pt.Launched||s===pt.Terminated)&&(this.game.isRunning?(Vs.addEventListeners({onNewEvent:this.onNewEvent,onInfoUpdate:this.onInfoUpdate}),(!localStorage.CUSTOM_GEP_ENABLED||localStorage.CUSTOM_GEP_ENABLED==="true")&&zs.addEventListeners({onNewEvent:this.onNewEvent,onInfoUpdate:this.onInfoUpdate})):(Vs.removeEventListeners(),zs.removeEventListeners(),await S.close(m.ASSISTANT),await S.close(m.GUIDES),await S.close(m.TIMELINE),await S.close(m.TEAMMATES),await S.close(m.INGAME),await S.close(m.DUELS),await S.close(m.SECOND_SCREEN),this.extension.windows[m.DESKTOP].state===R.Closed&&window.close()))},async onAppLaunchTriggered(s,e){this.game.isInFocus?this.extension.windows[m.INGAME].state!==R.Normal?await S.restore(m.INGAME):await S.minimize(m.INGAME):this.extension.windows[m.DESKTOP].state!==R.Normal?await S.restore(m.DESKTOP):await S.minimize(m.DESKTOP),s===ce.Url&&(e!=null&&e.includes("auth/authorize")&&await ht.signInCallback(null,e),e!=null&&e.includes("xp-")&&(this.xpHub.lastUpdateDate=Date.now(),e.includes("xp-purchase-credits-success")&&Ws.logEvent("purchase",{item_id:"credits",item_name:"XP Credits"})),await S.bringToFront(m.DESKTOP))},async onHotkeyPressed(s){if(s===Hs.TOGGLE){!this.game.session.match.isActive&&this.game.session.game.screenId==="Pregame"?this.extension.windows[m.INGAME].state!==R.Normal?(await S.restore(m.INGAME),await S.minimize(m.ASSISTANT)):(await S.minimize(m.INGAME),await S.restore(m.ASSISTANT)):(this.extension.windows[m.INGAME].state!==R.Normal?await S.restore(m.INGAME):await S.minimize(m.INGAME),this.extension.windows[m.ASSISTANT].state!==R.Closed&&await S.minimize(m.ASSISTANT),this.extension.windows[m.TEAMMATES].state!==R.Closed&&await S.minimize(m.TEAMMATES));return}if(s===Hs.SWITCH_VIEW){const e=["career-stats","previous-acts","match-stats","premier-stats"],t=e.findIndex(i=>i===this.gui.liveMatchView);t===e.length-1?this.gui.liveMatchView=e[0]:this.gui.liveMatchView=e[t+1];return}},async onHotkeyHold(s,e){s===Hs.TAB&&this.game.session.match.isActive&&this.extension.windows[m.INGAME].state!==R.Normal&&(e===_i.Down?await S.restore(m.TIMELINE):await S.minimize(m.TIMELINE))},async onWindowStateChanged(s,e,t){this.extension.windows[s].state=e,t===R.Hidden&&(t=R.Closed);const i=this.game.logicalWidth/this.game.width;if(s===m.DESKTOP&&e===R.Normal&&t===R.Closed){let n=this.system.monitors.find(d=>d.isPrimary),r={width:1280,height:720};const o=n.width/window.devicePixelRatio,a=n.height/window.devicePixelRatio;let l=o/2-r.width/2,h=a/2-r.height/2;await S.changeSize(s,r.width,r.height),await S.changePosition(s,l,h)}else if(s===m.INGAME&&e===R.Normal&&t===R.Closed){let n={width:this.game.logicalWidth,height:this.game.logicalHeight},r={width:1280,height:720},o=n.width/2-r.width/2,a=n.height/2-r.height/2;await S.changeSize(s,r.width,r.height),await S.changePosition(s,o,a)}else if(!(s===m.SECOND_SCREEN&&e===R.Normal&&t===R.Closed)){if(s===m.ASSISTANT&&e===R.Normal){let n={width:this.game.logicalWidth,height:this.game.logicalHeight},r={width:400,height:734},o=n.width-1.25*r.width,a=n.height/2-r.height/2;await S.changeSize(s,r.width,r.height),await S.changePosition(s,o,a)}else if(s===m.TIMELINE&&e===R.Normal){let n={width:this.game.logicalWidth,height:this.game.logicalHeight},r={width:1155,height:380};r.width=i*r.width;let o=n.width/2-r.width/2,a=n.height-315;n.height<910?a=n.height-230:n.height>1400&&(a=n.height-420),await S.changeSize(s,r.width,r.height),await S.changePosition(s,o,a)}else if(s===m.TEAMMATES&&e===R.Normal){let n={width:this.game.logicalWidth,height:this.game.logicalHeight},r={width:640,height:320};r.width=i*r.width;let o=n.width/2-r.width/2,a=n.height/2-r.height/1.75;await S.changeSize(s,r.width,r.height),await S.changePosition(s,o,a)}else if(s===m.GUIDES&&e===R.Normal&&t===R.Closed){let n={width:this.game.logicalWidth,height:this.game.logicalHeight},r={width:400,height:425},o=n.width-r.width,a=n.height-r.height;await S.changeSize(s,r.width,r.height),await S.changePosition(s,o,a)}}if(e===R.Closed){let n=0;for(let r in this.extension.windows)this.extension.windows[r].state!==R.Closed&&n++;n===1&&s!==m.ASSISTANT&&window.close()}},async onNewEvent({name:s,data:e}){this.game.session.handleEvent(s,e)},async onInfoUpdate({feature:s,info:e}){this.game.session.handleInfoUpdate(s,e),s==="match_info"&&e.match_info.round_phase&&(e.match_info.round_phase==="shopping"?this.settings.isGuideShowingEnabled?await S.restore(m.GUIDES):await S.close(m.GUIDES):e.match_info.round_phase==="combat"&&(this.settings.isGuideShowingEnabled?await S.minimize(m.GUIDES):await S.close(m.GUIDES)))}},watch:{"game.session.me.nickname"(s,e){s&&s!==e&&window.startWebSocketConnection()},"game.session.match.isActive"(s){s?this.media.enabledEvents.length>0&&ut.turnOn(this.media.enabledEvents,50):(!this.game.profile.updater.isConnecting&&!this.game.profile.updater.isConnected&&setTimeout(()=>{window.refreshGlobalStatsOnTimer()},60*1e3),setTimeout(async()=>{await ut.turnOff(),window.refreshHighlights()},3e4),this.media.enabledEvents.length>0&&window.refreshHighlights())},async"game.session.game.phaseId"(s,e){const t=s;(t==="MainMenu"||t==="InGame")&&this.extension.windows[m.TEAMMATES].state!==R.Closed&&(this.settings.isTeammatesWidgetEnabled?await S.minimize(m.TEAMMATES):await S.close(m.TEAMMATES))},async"game.session.game.screenId"(s,e){var n;const t=s,i=this.game.session.match.playlistId;if(!["range","npe"].includes(i))if(t==="Pregame"){await S.restore(m.ASSISTANT),this.settings.isTeammatesWidgetEnabled&&setTimeout(async()=>{await S.restore(m.TEAMMATES)},5e3);const r=await ds.getGameInfo();(n=r==null?void 0:r.me)!=null&&n.player_name&&(localStorage.nickname=this.game.session.me.nickname=r.me.player_name),this.game.profile.user||await window.refreshGlobalStats(),await window.refreshGlobalStats(this.game.session.match.playlistId),await window.refreshLast30DaysStats(this.game.session.match.playlistId)}else if(t==="TransitionToInGame"||t==="InGame")if(this.extension.windows[m.TEAMMATES].state!==R.Closed&&(this.settings.isTeammatesWidgetEnabled?await S.minimize(m.TEAMMATES):await S.close(m.TEAMMATES)),this.system.monitors.length>1&&this.settings.isSecondScreenEnabled&&await window.switchToSecondScreen(!1),t==="TransitionToInGame"){const r=this.game.session.agent.id;if(!this.game.guides[r]){let o=await ae.fetchGuides(r);o?this.$set(this.game.guides,r,o):this.$set(this.game.guides,r,[])}this.settings.isGuideShowingEnabled?this.game.guides[r].length>0&&await S.restore(m.GUIDES):await S.close(m.GUIDES)}else t==="InGame"&&await S.minimize(m.ASSISTANT);else(t==="TransitionToMainMenu"||t==="MainMenu")&&(this.extension.windows[m.ASSISTANT].state!==R.Closed&&await S.minimize(m.ASSISTANT),this.extension.windows[m.TEAMMATES].state!==R.Closed&&(this.settings.isTeammatesWidgetEnabled?await S.minimize(m.TEAMMATES):await S.close(m.TEAMMATES)),this.extension.windows[m.TIMELINE].state!==R.Closed&&await S.minimize(m.TIMELINE),this.extension.windows[m.GUIDES].state!==R.Closed&&(this.settings.isGuideShowingEnabled?await S.minimize(m.GUIDES):await S.close(m.GUIDES)))},"user.machineId"(s){Ws.setClientId(s)},"user.trn"(s){var e;Ws.setUserId(((e=s==null?void 0:s.profile)==null?void 0:e.sub)||null)}}};var uu=function(){var e=this,t=e._self._c;return t("div",{staticClass:"copyright"},[e._v(e._s(e.extension.name)+"  "+e._s(e.extension.author))])},du=[],fu=no(hu,uu,du,!1,null,null);const pu=fu.exports,mu="1.26.1",gu=new ro({apiKey:oo.BUGSNAG_API_KEY,appVersion:mu});window.bugsnag=gu.getInstance();Tn.config.productionTip=!1;window.isProduction=!0;new Tn({render:s=>s(pu)}).$mount("#app");
